<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake-test</title>
    <style>
        :root {
            --bg-color: #1e1e1e;
            --text-color: #d4d4d4;
            --header-bg: #252526;
            --sidebar-bg: #252526;
            --sidebar-hover: #2a2d2e;
            --sidebar2-bg: #252526;
            --sidebar2-hover: #2a2d2e;
            --content-bg: #1e1e1e;
            --button-bg: #3498db;
            --card-bg: #2d2d2d;
            --card-border: #3a3a3a;
            --highlight-color: #4CAF50;
            --warning-color: #FFC107;
            --danger-color: #F44336;
        }

        .light-theme {
            --bg-color: #f5f5f5;
            --text-color: #333333;
            --header-bg: #ffffff;
            --sidebar-bg: #f0f0f0;
            --sidebar-hover: #e0e0e0;
            --sidebar2-bg: #f0f0f0;
            --sidebar2-hover: #e0e0e0;
            --content-bg: #ffffff;
            --button-bg: #2980b9;
            --card-bg: #ffffff;
            --card-border: #e0e0e0;
            --highlight-color: #2E7D32;
            --warning-color: #FF8F00;
            --danger-color: #D32F2F;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
        }

        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            background-color: var(--header-bg);
            color: var(--text-color);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--sidebar-hover);
            transition: background-color 0.3s, color 0.3s;
        }

        .title {
            font-size: 20px;
            font-weight: bold;
        }

        .luogu-btn {
            padding: 6px 12px;
            background-color: var(--button-bg);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .luogu-btn:hover {
            background-color: var(--button-bg);
            opacity: 0.9;
        }

        .main-container {
            display: flex;
            flex: 1;
        }

        .sidebar {
            position: fixed;
            top: 40px;
            height: 100vh;
            left: 0;
            width: 80px;
            background-color: var(--sidebar-bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 20px;
            transition: background-color 0.3s;
        }

        .sidebar-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
            cursor: pointer;
            padding: 10px;
            border-radius: 4px;
            width: 60px;
            text-align: center;
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }

        .sidebar-item:hover {
            background-color: var(--sidebar-hover);
        }

        .sidebar-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .sidebar-label {
            font-size: 12px;
        }

        .sidebar2 {
            position: fixed;
            top: 40px;
            height: 100vh;
            right: 0;
            width: 80px;
            background-color: var(--sidebar2-bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 20px;
            transition: background-color 0.3s;
        }

        .sidebar2-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
            cursor: pointer;
            padding: 10px;
            border-radius: 4px;
            width: 60px;
            text-align: center;
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }

        .sidebar2-item:hover {
            background-color: var(--sidebar2-hover);
        }

        .sidebar2-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .sidebar2-label {
            font-size: 12px;
        }

        .content {
            flex: 1;
            margin-left: 80px;
            /* 给左侧边栏留出空间 */
            margin-right: 80px;
            /* 给右侧边栏留出空间 */
            margin-top: 20px;
            background-color: var(--content-bg);
            padding: 20px 20px 20px 40px;
            transition: background-color 0.3s;
            overflow-y: auto;
            margin-right: 80px;
            height: calc(100vh - 60px);
            z-index: 0;
        }

        .content h1,
        .content h3 {
            margin-left: 20px;
            max-width: 800px;
        }

        .theme-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--button-bg);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s, transform 0.2s;
            z-index: 100;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        .settings-toggle {
            position: fixed;
            bottom: 20px;
            right: 70px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--button-bg);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s, transform 0.2s;
            z-index: 100;
        }

        .settings-toggle:hover {
            transform: scale(1.1);
        }

        /* 确保所有内容区域默认隐藏 */
        .algorithm-section,
        .calendar-section,
        .roadmap-section,
        .daily-section,
        .game-section,
        .weather-section,
        .article-section,
        .discussion-section {
            display: none;
        }

        /* 激活的部分显示 */
        .active-section {
            display: block;
        }

        .algorithm-categories,
        .calendar-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }

        .category-btn,
        .filter-btn {
            padding: 8px 15px;
            background-color: var(--button-bg);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: opacity 0.3s;
        }

        .category-btn:hover,
        .filter-btn:hover {
            opacity: 0.9;
        }

        .algorithm-cards,
        .calendar-events,
        .roadmap-steps,
        .daily-problems {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .algorithm-card,
        .event-card,
        .step-card,
        .problem-card,
        .weather-card {
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 15px;
            transition: transform 0.2s;
        }

        .algorithm-card:hover,
        .event-card:hover,
        .step-card:hover,
        .problem-card:hover,
        .weather-card:hover {
            transform: translateY(-5px);
        }

        .algorithm-title,
        .event-title,
        .step-title,
        .problem-title,
        .weather-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--button-bg);
        }

        .algorithm-desc,
        .event-desc,
        .step-desc,
        .problem-desc,
        .weather-desc {
            font-size: 14px;
            margin-bottom: 10px;
        }

        .algorithm-code {
            background-color: var(--sidebar-bg);
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 13px;
            overflow-x: auto;
            margin-bottom: 10px;
        }

        .copy-btn,
        .view-btn {
            background-color: var(--button-bg);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: opacity 0.3s;
            margin-right: 5px;
        }

        .copy-btn:hover,
        .view-btn:hover {
            opacity: 0.9;
        }

        .active-section {
            display: block;
        }

        /* 加载界面样式 */
        .loader-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(30, 30, 30, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        .loader {
            position: relative;
        }

        .bar {
            width: 15em;
            height: 15em;
            border-radius: 50%;
            border: 8px solid transparent;
            border-top: 8px solid rgb(255, 255, 255);
            animation: spin 0.8s linear infinite;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: rotate(360deg);
                opacity: 0.8;
            }
        }

        /* 竞赛日历特定样式 */
        .event-date {
            font-weight: bold;
            color: var(--highlight-color);
            margin-bottom: 5px;
        }

        .event-platform {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            margin-right: 5px;
            margin-bottom: 5px;
        }

        .platform-luogu {
            background-color: #3498db;
            color: white;
        }

        .platform-codeforces {
            background-color: #3b5998;
            color: white;
        }

        .platform-atcoder {
            background-color: #e74c3c;
            color: white;
        }

        .platform-leetcode {
            background-color: #f39c12;
            color: white;
        }

        /* 学习路线特定样式 */
        .step-level {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .step-beginner {
            color: var(--highlight-color);
        }

        .step-intermediate {
            color: var(--warning-color);
        }

        .step-advanced {
            color: var(--danger-color);
        }

        .step-resources {
            font-size: 13px;
            margin-top: 10px;
        }

        /* 每日一题特定样式 */
        .problem-difficulty {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            margin-right: 5px;
        }

        .difficulty-easy {
            background-color: var(--highlight-color);
            color: white;
        }

        .difficulty-medium {
            background-color: var(--warning-color);
            color: black;
        }

        .difficulty-hard {
            background-color: var(--danger-color);
            color: white;
        }

        /* 天气插件样式 */
        .weather-info {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .weather-icon {
            font-size: 36px;
            margin-right: 15px;
        }

        .weather-temp {
            font-size: 24px;
            font-weight: bold;
        }

        .weather-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 14px;
        }

        .weather-detail {
            display: flex;
            align-items: center;
        }

        .weather-detail i {
            margin-right: 5px;
            width: 20px;
            text-align: center;
        }

        /* 时间显示样式 */
        .time-display {
            position: fixed;
            top: 10px;
            left: 130px;
            font-size: 14px;
            background-color: var(--header-bg);
            padding: 5px 10px;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 100;
            margin: 0;
        }

        /* 名人名言样式 */
        .quote-container {
            position: fixed;
            bottom: 70px;
            right: 20px;
            max-width: 300px;
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 99;
        }

        .quote-text {
            font-style: italic;
            margin-bottom: 10px;
        }

        .quote-author {
            text-align: right;
            font-weight: bold;
        }

        .game-section {
            display: none;
        }

        .game-section.active-section {
            display: block;
        }

        .game-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            max-width: 600px;
        }

        .game-btn {
            padding: 15px;
            background-color: var(--button-bg);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.2s;
        }

        .game-btn:hover {
            transform: translateY(-3px);
        }

        .welcome-box {
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 20px;
            background-color: var(--card-bg);
            margin-bottom: 20px;
        }

        .modalwelcome {
            display: flex;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            /* 半透明背景 */
            z-index: 100000;
            /* 确保模态框在最上层 */
        }

        .modalwelcome-content {
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 20px;
            max-width: 80%;
            /* 最大宽度为屏幕宽度的80% */
            max-height: 80%;
            /* 最大高度为屏幕高度的80% */
            overflow-y: auto;
            /* 内容过多时允许滚动 */
        }

        .close-btn {
            float: right;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
        }

        .close-btn:hover {
            color: red;
        }

        .closewelcome-btn {
            float: right;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
        }

        .closewelcome-btn:hover {
            color: red;
        }

        /* 登录/注册模态框样式 */
        .modal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background-color: var(--card-bg);
            margin: 10% auto;
            padding: 20px;
            border: 1px solid var(--card-border);
            border-radius: 8px;
            width: 300px;
            position: relative;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
        }

        .form-group input {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--card-border);
            border-radius: 4px;
            background-color: var(--sidebar-bg);
            color: var(--text-color);
        }

        /* 文章编辑器样式 */
        .article-editor {
            display: none;
            margin: 20px;
            max-width: 800px;
        }

        .article-editor.active-section {
            display: block;
        }

        .article-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .article-form input,
        .article-form textarea,
        .article-form select {
            padding: 8px;
            border: 1px solid var(--card-border);
            border-radius: 4px;
            background-color: var(--sidebar-bg);
            color: var(--text-color);
        }

        .article-form textarea {
            min-height: 200px;
            resize: vertical;
        }

        .article-form button {
            align-self: flex-start;
        }

        /* 文章列表样式 */
        .article-list {
            display: none;
            margin: 20px;
            max-width: 800px;
        }

        .article-list.active-section {
            display: block;
        }

        .article-card {
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            transition: transform 0.2s;
        }

        .article-card:hover {
            transform: translateY(-3px);
        }

        .article-card h3 {
            margin-top: 0;
            color: var(--button-bg);
        }

        .article-meta {
            font-size: 12px;
            color: #aaa;
            margin-bottom: 10px;
        }

        .article-content {
            margin-bottom: 10px;
        }

        .article-actions {
            display: flex;
            gap: 10px;
        }

        /* 文章分类标签 */
        .article-category {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            margin-right: 5px;
            background-color: var(--button-bg);
            color: white;
        }

        /* Markdown预览样式 */
        .article-preview {
            border: 1px solid var(--card-border);
            border-radius: 4px;
            padding: 15px;
            min-height: 200px;
            background-color: var(--sidebar-bg);
            margin-bottom: 15px;
        }

        .article-preview h1,
        .article-preview h2,
        .article-preview h3,
        .article-preview h4,
        .article-preview h5,
        .article-preview h6 {
            color: var(--button-bg);
            margin-top: 1em;
            margin-bottom: 0.5em;
        }

        .article-preview p {
            margin-bottom: 1em;
            line-height: 1.6;
        }

        .article-preview pre {
            background-color: var(--sidebar-hover);
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }

        .article-preview code {
            font-family: monospace;
            background-color: var(--sidebar-hover);
            padding: 2px 4px;
            border-radius: 3px;
        }

        .article-preview blockquote {
            border-left: 3px solid var(--button-bg);
            padding-left: 15px;
            margin-left: 0;
            color: var(--text-color);
            opacity: 0.8;
        }

        .article-preview table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 1em;
        }

        .article-preview th,
        .article-preview td {
            border: 1px solid var(--card-border);
            padding: 8px;
        }

        .article-preview img {
            max-width: 100%;
        }

        /* Markdown编辑器样式 */
        .EasyMDEContainer {
            margin-bottom: 15px;
        }

        .EasyMDEContainer .CodeMirror {
            background-color: var(--sidebar-bg);
            color: var(--text-color);
            border: 1px solid var(--card-border);
            border-radius: 4px;
        }

        .EasyMDEContainer .CodeMirror-focused {
            border-color: var(--button-bg);
        }

        .EasyMDEContainer .editor-toolbar {
            background-color: var(--sidebar-bg);
            border: 1px solid var(--card-border);
            border-bottom: none;
            opacity: 1;
        }

        .EasyMDEContainer .editor-toolbar button {
            color: var(--text-color);
        }

        .EasyMDEContainer .editor-toolbar button:hover,
        .EasyMDEContainer .editor-toolbar button.active {
            background-color: var(--sidebar-hover);
            border-color: var(--card-border);
        }

        /* 文章查看模态框样式 */
        .article-modal {
            display: none;
            position: fixed;
            z-index: 1002;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
        }

        .article-modal-content {
            background-color: var(--card-bg);
            margin: 2% auto;
            padding: 20px;
            border: 1px solid var(--card-border);
            border-radius: 8px;
            width: 80%;
            max-height: 90vh;
            overflow-y: auto;
        }

        /* 修改后的模态框样式，添加 snake- 前缀 */
        .snake-modal {
            display: none;
            position: fixed;
            z-index: var(--modal-zindex);
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.8);
        }

        .snake-modal-content {
            background-color: var(--card-bg);
            margin: 5% auto;
            padding: 20px;
            border: 1px solid var(--card-border);
            width: 80%;
            max-width: 900px;
            max-height: 80vh;
            overflow-y: auto;
            border-radius: 8px;
        }

        .snake-modal-close {
            color: var(--text-color);
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .snake-article-content {
            line-height: 1.6;
            font-size: 16px;
        }

        .snake-article-content img {
            max-width: 100%;
        }

        .snake-article-content pre {
            background-color: var(--sidebar-bg);
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }

        .resources-section {
            display: none;
        }

        .resources-section.active-section {
            display: block;
        }

        .resources-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .resource-card {
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 15px;
            transition: transform 0.2s;
        }

        .resource-card:hover {
            transform: translateY(-5px);
        }

        .resource-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--button-bg);
        }

        .resource-desc {
            font-size: 14px;
            margin-bottom: 10px;
        }

        .resource-link {
            color: var(--highlight-color);
            text-decoration: none;
            font-weight: bold;
        }

        .resource-link:hover {
            text-decoration: underline;
        }

        /* 设置面板样式 */
        .settings-panel {
            display: none;
            position: fixed;
            bottom: 70px;
            right: 70px;
            width: 250px;
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 101;
        }

        .settings-panel h3 {
            margin-top: 0;
            margin-bottom: 15px;
            color: var(--button-bg);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .setting-label {
            font-size: 14px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: var(--button-bg);
        }

        input:checked+.slider:before {
            transform: translateX(26px);
        }

        .article-card.official {
            border-left: 4px solid var(--highlight-color);
        }

        .article-card .official-badge {
            display: inline-block;
            background-color: var(--highlight-color);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            margin-left: 10px;
        }

        .comments-section {
            margin-top: 30px;
            border-top: 1px solid var(--card-border);
            padding-top: 20px;
        }

        .comment-form {
            margin-top: 20px;
        }

        .comment-form textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--card-border);
            border-radius: 4px;
            background-color: var(--sidebar-bg);
            color: var(--text-color);
            min-height: 80px;
            margin-bottom: 10px;
            resize: vertical;
        }

        .comment {
            background-color: var(--sidebar-bg);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 15px;
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .comment-author {
            font-weight: bold;
            color: var(--button-bg);
        }

        .comment-date {
            color: #aaa;
            font-size: 12px;
        }

        .comment-content {
            line-height: 1.5;
        }

        .favorite-btn.active {
            background-color: var(--highlight-color);
        }

        .favorites-section {
            display: none;
        }

        .favorites-section.active-section {
            display: block;
        }
    </style>

    <style id="comments-style">
        #comments-1 {
            display: none;
        }

        #comments-2 {
            display: block;
        }
    </style>

    <!-- 引入必要的CSS库 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/github.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/easymde@2.18.0/dist/easymde.min.css">
</head>

<body>
    <!-- 添加加载动画 -->
    <div class="loader-overlay" id="loader" style="display: flex; opacity: 1; z-index: 100000000;">
        <div class="loader">
            <div class="bar"></div>
        </div>
        <div style="position: fixed; opacity: 1; z-index: 10000001;">
            <strong>拼命加载中，请稍等...<br>如果卡住了，<br>请刷新或检查网络。</strong>
        </div>
    </div>

    <div class="header">
        <div class="title">Snake-test</div>
        <div class="time-display" id="time-display"></div>
        <div id="userStatus" style="position: fixed; top: 7px; right: 10px;">
            <span id="userGreeting"></span>
            <button id="logoutBtn" class="luogu-btn" style="display: none; margin-left: 10px;">退出</button>
            <button id="loginBtn" class="luogu-btn" style="margin-left: 10px;">登录/注册</button>
            <button class="luogu-btn" id="luogu-team-btn">洛谷团队</button>
        </div>

        <!-- 登录模态框 -->
        <div id="loginModal" class="modal">
            <div class="modal-content">
                <span class="close-btn">&times;</span>
                <h2>用户登录</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username">用户名:</label>
                        <input type="text" id="username" required>
                    </div>
                    <div class="form-group">
                        <label for="password">密码:</label>
                        <input type="password" id="password" required>
                    </div>
                    <button type="submit" class="luogu-btn">登录</button>
                </form>
                <p>还没有账号? <a href="#" id="showRegister">立即注册</a></p>
            </div>
        </div>

        <!-- 注册模态框 -->
        <div id="registerModal" class="modal">
            <div class="modal-content">
                <span class="close-btn">&times;</span>
                <h2>用户注册</h2>
                <form id="registerForm">
                    <div class="form-group">
                        <label for="newUsername">用户名:</label>
                        <input type="text" id="newUsername" required>
                    </div>
                    <div class="form-group">
                        <label for="newPassword">密码:</label>
                        <input type="password" id="newPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">确认密码:</label>
                        <input type="password" id="confirmPassword" required>
                    </div>
                    <button type="submit" class="luogu-btn">注册</button>
                </form>
                <p>已有账号? <a href="#" id="showLogin">立即登录</a></p>
            </div>
        </div>
    </div>

    <div class="main-container">
        <div class="sidebar">
            <div class="sidebar-item" id="game-link">
                <div class="sidebar-icon"><i class="fas fa-gamepad"></i></div>
                <div class="sidebar-label">小游戏</div>
            </div>
            <div class="sidebar-item" id="calendar-link">
                <div class="sidebar-icon"><i class="fas fa-calendar-alt"></i></div>
                <div class="sidebar-label">竞赛日历</div>
            </div>
            <div class="sidebar-item" id="notes-link">
                <div class="sidebar-icon"><i class="fas fa-book"></i></div>
                <div class="sidebar-label">随手记</div>
            </div>
            <div class="sidebar-item" id="article-link">
                <div class="sidebar-icon"><i class="fas fa-file-alt"></i></div>
                <div class="sidebar-label">文章</div>
            </div>
            <div class="sidebar-item" id="editor-link">
                <div class="sidebar-icon"><i class="fas fa-laptop-code"></i></div>
                <div class="sidebar-label">编辑器</div>
            </div>
            <div class="sidebar-item" id="favorites-link">
                <div class="sidebar-icon"><i class="fas fa-heart"></i></div>
                <div class="sidebar-label">收藏</div>
            </div>
            <div class="sidebar-item" id="discussion-link">
                <div class="sidebar-icon"><i class="fas fa-paper-plane"></i></div>
                <div class="sidebar-label">讨论</div>
            </div>
        </div>

        <!-- Welcome模态框 -->
        <div id="welcomeModal" class="modalwelcome">
            <div class="modalwelcome-content">
                <span class="closewelcome-btn">&times;</span>
                <div class="welcome-box">
                    <h1>Welcome!</h1>
                    <h3>欢迎来到Snake-test 2.9！本网站由zhangyimin12345 &amp; wbw121124制作，供snake集团成员使用。</h3>
                    <h3>用于作者们是HTML辣鸡，有什么建议欢迎提出！</h3>
                    <h3>本网站的主要功能都在侧边栏里，你可以点击查看。推荐用暗色主题。</h3>
                    <h3>注：因为没有后端，切换浏览器、电脑所有数据都会清除！！！</h3>
                    <h3>注：随手记即Markdown编辑器。</h3>
                    <h3>注：文章功能炸了。</h3>
                    <h3>注：小游戏·跑酷炸了，还没修好。有些地方缺斤少两，慢慢修吧。</h3>
                    <h3>注：有些东西处于试验阶段、未补充资源或未调用API。</h3>
                    <h3>鸣谢：wbw121124提供了编辑器功能，讨论板块也借鉴了他的代码。</h3>
                </div>
            </div>
        </div>

        <div class="content">
            <div id="discussion-section" class="discussion-section">
                <h1>讨论</h1>
                <h3>目前只支持反馈问题！！！</h3>
                <main id="test-snake-chat"> <span
                        style="display: inline-flex; flex-direction: row; flex-wrap: nowrap; align-content: flex-start; justify-content: flex-start; margin: 0; padding: 0; align-items: center; background-color: #F6F8FA; box-sizing: border-box; border-radius: .375rem; border-color: #d0d7de; border: 0 solid !important;">
                        <button id="utteranc-btn" onclick="showchatbox(1)" class="luogu-btn"> utteranc </button> <button
                            id="giscus-btn" onclick="showchatbox(2)" class="luogu-btn"> giscus </button>
                        <script> function showchatbox(x) { if (x == 2) { document.getElementById("comments-style").innerHTML = `#comments-1 { display: none; } #comments-2 { display: block; }`; document.getElementById("giscus-btn").classList.add("clicked"); document.getElementById("utteranc-btn").classList.add("clicked"); document.getElementById("utteranc-btn").classList.remove("clicked"); } else { document.getElementById("comments-style").innerHTML = `#comments-2 { display: none; } #comments-1 { display: block; }`; document.getElementById("utteranc-btn").classList.add("clicked"); document.getElementById("giscus-btn").classList.add("clicked"); document.getElementById("giscus-btn").classList.remove("clicked"); } } </script>
                    </span>
                    <div id="comments-1">
                        <script src="https://utteranc.es/client.js" repo="zhangyimin12345/snake-test-3.2"
                            label="Utterances" issue-term="url" theme="github-light" crossorigin="anonymous"
                            async> </script>
                    </div>
                    <div id="comments-2">
                        <script src="https://giscus.app/client.js" data-repo="zhangyimin12345/snake-test-3.2"
                            data-repo-id="R_kgDOOU0qJQ" data-category="Announcements"
                            data-category-id="DIC_kwDOOU0qJc4CpFLJ" data-mapping="url" data-strict="1"
                            data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top"
                            data-theme="light" data-lang="zh-CN" crossorigin="anonymous" async> </script>
                    </div>
                </main>
            </div>

            <div id="favorites-section" class="favorites-section">
                <h1>收藏</h1>
                <div id="favorites-container"></div>
            </div>

            <div id="resources-section" class="resources-section">
                <h1>学习资源</h1>

                <!-- <div class="content"> -->
                <h3>网站/课程</h3>
                <div class="resources-list" id="resources-list">
                    <!-- 学习资源将通过 JavaScript 动态加载 -->
                </div>
                <!-- </div> -->

            </div>

            <!-- 文章查看模态框 -->
            <div id="snake-article-modal" class="snake-modal">
                <div class="snake-modal-content">
                    <span class="snake-modal-close">&times;</span>
                    <h2 id="snake-modal-article-title"></h2>
                    <div id="snake-modal-article-content" class="snake-article-content"></div>
                    <div class="comments-section">
                        <h3>评论</h3>
                        <div id="comments-container-${articleId}"></div>
                        <div class="comment-form">
                            <textarea id="comment-input-${articleId}" placeholder="写下你的评论..."></textarea>
                            <button class="luogu-btn submit-comment" data-article="${articleId}">提交评论</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="article-section" class="article-section">
                <h1>文章</h1>
                <h3>其实就是剪贴板。</h3>
                <h3>注：因为没有后端，切换浏览器、电脑所有数据都会清除！！！</h3>
                <h3>注：如果有高质量的文章，并且学术相关（如DeepSeek替代品列表），请检查Markdown中是否有"号与\n符号，如果没有，请把Markdown发给zhangyimin12345。</h3>
                <div class="article-controls">
                    <button id="new-article-btn" class="luogu-btn">新建文章</button>
                    <button id="view-articles-btn" class="luogu-btn">查看文章</button>
                </div>

                <!-- 文章编辑器 -->
                <div id="article-editor" class="article-editor">
                    <h3>发布新文章</h3>
                    <form id="article-form" class="article-form">
                        <div class="form-group">
                            <label for="article-title">标题:</label>
                            <input type="text" id="article-title" required>
                        </div>
                        <div class="form-group">
                            <label for="article-category">分类:</label>
                            <select id="article-category" required>
                                <option value="教程">教程</option>
                                <option value="算法">算法</option>
                                <option value="题解">题解</option>
                                <option value="公告">公告</option>
                                <option value="其他">其他</option>
                                <option value="官方">官方</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="article-content">内容 (支持Markdown):</label>
                            <textarea id="article-content" required></textarea>
                            <h4>如果要Katex预览，请使用<a href="https://zhangyimin12345.github.io/snake-test-2-markdown/"
                                    target="_blank">随手记</a>。</h4>
                        </div>
                        <button type="submit" class="luogu-btn">发布文章</button>
                        <button type="button" id="cancel-edit" class="luogu-btn">取消</button>
                    </form>
                </div>

                <!-- 文章列表 -->
                <div id="article-list" class="article-list">
                    <h3>文章列表</h3>
                    <div id="articles-container">
                        <!-- 文章将通过JavaScript动态加载 -->
                    </div>
                    <button id="back-to-editor" class="luogu-btn">返回编辑器</button>
                </div>
            </div>

            <!-- 小游戏内容 -->
            <div id="game-section" class="game-section">
                <h1>小游戏</h1>
                <h3>选择您想玩的游戏</h3>

                <div class="game-buttons">
                    <button class="game-btn" data-game="parkour">简易跑酷</button>
                    <button class="game-btn" data-game="tetris">俄罗斯方块</button>
                    <button class="game-btn" data-game="minesweeper">扫雷</button>
                    <button class="game-btn" data-game="snake">贪吃蛇</button>
                </div>
            </div>

            <!-- 算法模板库内容 -->
            <div id="algorithm-section" class="algorithm-section">
                <h1>算法模板库</h1>
                <h3>常用算法代码模板，点击分类查看，点击复制按钮可直接复制代码（未补充资源）</h3>

                <div class="algorithm-categories">
                    <button class="category-btn" data-category="sort">排序算法</button>
                    <button class="category-btn" data-category="search">搜索算法</button>
                    <button class="category-btn" data-category="graph">图论</button>
                    <button class="category-btn" data-category="dp">动态规划</button>
                    <button class="category-btn" data-category="math">数学</button>
                </div>

                <div class="algorithm-cards" id="algorithm-cards">
                    <!-- 内容将通过JavaScript动态加载 -->
                </div>
            </div>

            <!-- 竞赛日历内容 -->
            <div id="calendar-section" class="calendar-section">
                <h1>竞赛日历</h1>
                <h3>近期编程竞赛时间表，点击平台筛选（未补充资源）</h3>

                <div class="calendar-filters">
                    <button class="filter-btn" data-platform="all">全部</button>
                    <button class="filter-btn" data-platform="luogu">洛谷</button>
                    <button class="filter-btn" data-platform="codeforces">Codeforces</button>
                    <button class="filter-btn" data-platform="atcoder">AtCoder</button>
                    <button class="filter-btn" data-platform="leetcode">LeetCode</button>
                </div>

                <div class="calendar-events" id="calendar-events">
                    <!-- 内容将通过JavaScript动态加载 -->
                </div>
            </div>

            <!-- 学习路线内容 -->
            <div id="roadmap-section" class="roadmap-section">
                <h1>编程学习路线</h1>
                <h3>从入门到进阶的系统学习路径（未补充资源）</h3>

                <div class="roadmap-steps" id="roadmap-steps">
                    <!-- 内容将通过JavaScript动态加载 -->
                </div>
            </div>

            <!-- 每日一题内容 -->
            <div id="daily-section" class="daily-section">
                <h1>每日一题</h1>
                <h3>每日精选编程题目，提升算法能力（试验阶段）</h3>

                <button class="view-btn" onclick="(() => {
	function goto_url(url, param) {
		var flag = 0;
		for (var key in param) {
			url = url + ((!flag) ? '?' : '&');
			url = url + key + '=' + encodeURIComponent(param[key]);
			flag = 1;
		}
		window.location = url;
	};
	goto_url('https://www.luogu.com.cn/problemnew/show/P' +
		(parseInt(Math.random(0, 1) * 9800) + 1000));
})();">洛谷随机跳题</button>
                <br />
                <p>本期内容：<strong>最短路</strong></p>
                <p>由 <strong>AI</strong> 筛选，内容可能有误</p>
                <div class="daily-problems" id="daily-problems">
                    <!-- 内容将通过JavaScript动态加载 -->
                </div>
            </div>
        </div>

        <div class="sidebar2">
            <div class="sidebar2-item" id="resources-link">
                <div class="sidebar2-icon"><i class="fas fa-book-reader"></i></div>
                <div class="sidebar2-label">学习资源</div>
            </div>
            <div class="sidebar2-item" id="algorithm-link">
                <div class="sidebar2-icon"><i class="fas fa-code"></i></div>
                <div class="sidebar2-label">算法模板</div>
            </div>
            <div class="sidebar2-item" id="roadmap-link">
                <div class="sidebar2-icon"><i class="fas fa-map-signs"></i></div>
                <div class="sidebar2-label">学习路线</div>
            </div>
            <div class="sidebar2-item" id="daily-link">
                <div class="sidebar2-icon"><i class="fas fa-question-circle"></i></div>
                <div class="sidebar2-label">每日一题</div>
            </div>
        </div>
    </div>

    <button class="theme-toggle" id="theme-toggle">
        <i class="fas fa-moon"></i>
    </button>

    <button class="settings-toggle fas fa-cog" id="settings-toggle"></button>

    <!-- 设置面板 -->
    <div class="settings-panel" id="settings-panel">
        <h3>设置</h3>
        <div class="setting-item">
            <span class="setting-label">波浪效果</span>
            <label class="switch">
                <input type="checkbox" id="wave-effect-toggle">
                <span class="slider"></span>
            </label>
        </div>
        <div class="setting-item">
            <span class="setting-label">雪花效果</span>
            <label class="switch">
                <input type="checkbox" id="snow-effect-toggle">
                <span class="slider"></span>
            </label>
        </div>
        <div class="setting-item">
            <span class="setting-label">名人名言</span>
            <label class="switch">
                <input type="checkbox" id="quote-toggle">
                <span class="slider"></span>
            </label>
        </div>
    </div>

    <div class="quote-container" id="quote-container">
        <div class="quote-text" id="quote-text"></div>
        <div class="quote-author" id="quote-author"></div>
    </div>

    <!-- 脚本加载改为动态 -->
    <script src="https://cdn.jsdelivr.net/npm/marked@4.2.12/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
    <script src="https://cdn.staticfile.net/highlight.js/11.7.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/easymde@2.18.0/dist/easymde.min.js"></script>
    <!-- <script>(() => { const canvas = document.createElement('canvas'); document.body.appendChild(canvas); canvas.style = "display: block;position: fixed;top: 0;left: 0;pointer-events: none;"; const ctx = canvas.getContext('2d'); function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight } resizeCanvas(); window.addEventListener('resize', () => { resizeCanvas() }); const gravity = 0.5; const damping = 0.8; const ballRadius = 7.5; let balls = []; class Ball { constructor(x, y, radius) { this.x = x; this.y = y; this.cnt = 0; this.radius = radius * (Math.random() + 0.75); this.vx = (Math.random() - 0.5) * 12.5; this.vy = (Math.random() * 2 - 1.25) * 10; this.mass = radius * 0.5; this.color = `hsl(${Math.random() * 360},70%,50%)`; this.tot = 0; this.type = Math.random() > 0.5 } update() { this.vy += gravity; this.x += this.vx; this.y += this.vy; let last = this.tot; if (this.x < this.radius) { this.vx *= -damping; this.x = this.radius; this.tot++ } if (this.x > canvas.width - this.radius) { this.vx *= -damping; this.x = canvas.width - this.radius; this.tot++ } if (this.y < this.radius) { this.vy *= -damping; this.y = this.radius; this.tot++ } if (this.y > canvas.height - this.radius) { this.vy *= -damping; this.y = canvas.height - this.radius; this.tot++ } last = this.tot - last; if (last > 0) this.radius = this.radius * 7 / 8 } draw() { ctx.beginPath(); ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2); ctx.fillStyle = this.color; ctx.fill(); ctx.closePath() } } function checkCollisions() { for (let i = 0; i < balls.length; i++) { for (let j = i + 1; j < balls.length; j++) { const ball1 = balls[i]; const ball2 = balls[j]; const dx = ball2.x - ball1.x; const dy = ball2.y - ball1.y; const distance = Math.sqrt(dx * dx + dy * dy); if (distance < ball1.radius + ball2.radius) { const nx = dx / distance; const ny = dy / distance; const dvx = ball2.vx - ball1.vx; const dvy = ball2.vy - ball1.vy; const dotProduct = dvx * nx + dvy * ny; if (dotProduct >= 0) continue; const impulse = (-(1 + damping) * dotProduct) / (1 / ball1.mass + 1 / ball2.mass); ball1.vx -= (impulse * nx) / ball1.mass; ball1.vy -= (impulse * ny) / ball1.mass; ball2.vx += (impulse * nx) / ball2.mass; ball2.vy += (impulse * ny) / ball2.mass; const overlap = (ball1.radius + ball2.radius - distance) / 2; ball1.x -= nx * overlap; ball1.y -= ny * overlap; ball2.x += nx * overlap; ball2.y += ny * overlap } } } } function init() { for (let i = 0; i < 10; i++) { balls.push(new Ball(Math.random() * (canvas.width - 2 * ballRadius) + ballRadius, Math.random() * (canvas.height - 2 * ballRadius) + ballRadius, ballRadius)) } } function animate() { ctx.clearRect(0, 0, canvas.width, canvas.height); balls.forEach(ball => { ball.cnt++; ball.update(); ball.draw() }); for (let i = 0; i < balls.length; i++) { if ((balls[i].cnt > 10000 || balls[i].radius < 0.01) && balls.length > 5) { balls.splice(i, 1); i-- } } while (balls.length > 25) { balls.splice(0, 1) } checkCollisions(); requestAnimationFrame(animate) } document.addEventListener('click', (e) => { for (let i = 0; i < 5; i++) { balls.push(new Ball(e.clientX, e.clientY, ballRadius)) } }); init(); animate() })();</script> -->
    <script>
        // 主题切换功能
        const themeToggle = document.getElementById('theme-toggle');
        const icon = themeToggle.querySelector('i');

        // 检查本地存储的主题偏好
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'light') {
            document.body.classList.add('light-theme');
            icon.classList.replace('fa-moon', 'fa-sun');
        }

        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('light-theme');

            if (document.body.classList.contains('light-theme')) {
                icon.classList.replace('fa-moon', 'fa-sun');
                localStorage.setItem('theme', 'light');
            } else {
                icon.classList.replace('fa-sun', 'fa-moon');
                localStorage.setItem('theme', 'dark');
            }
        });

        // 设置面板功能
        const settingsToggle = document.getElementById('settings-toggle');
        const settingsPanel = document.getElementById('settings-panel');

        settingsToggle.addEventListener('click', function () {
            if (settingsPanel.style.display === 'block') {
                settingsPanel.style.display = 'none';
            } else {
                settingsPanel.style.display = 'block';
            }
        });

        // 点击设置面板外部关闭面板
        document.addEventListener('click', function (event) {
            if (!settingsPanel.contains(event.target) && event.target !== settingsToggle) {
                settingsPanel.style.display = 'none';
            }
        });

        // 存储键名
        const COMMENTS_KEY = 'snake_test_comments';
        const FAVORITES_KEY = 'snake_test_favorites';

        // 初始化存储
        if (!localStorage.getItem(COMMENTS_KEY)) {
            localStorage.setItem(COMMENTS_KEY, JSON.stringify({}));
        }

        if (!localStorage.getItem(FAVORITES_KEY)) {
            localStorage.setItem(FAVORITES_KEY, JSON.stringify({}));
        }

        // 获取当前用户
        function getCurrentUser() {
            const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
            return currentUser ? currentUser.username : null;
        }

        // 添加评论功能
        function addComment(articleId, content) {
            const user = getCurrentUser();
            if (!user) {
                alert('请先登录后再评论');
                return false;
            }

            if (!content.trim()) {
                alert('评论内容不能为空');
                return false;
            }

            const comments = JSON.parse(localStorage.getItem(COMMENTS_KEY));
            if (!comments[articleId]) {
                comments[articleId] = [];
            }

            comments[articleId].push({
                author: user,
                content: content,
                timestamp: new Date().toISOString()
            });

            localStorage.setItem(COMMENTS_KEY, JSON.stringify(comments));
            return true;
        }

        // 渲染评论
        function renderComments(articleId) {
            const container = document.getElementById(`comments-container-${articleId}`);
            if (!container) return;

            container.innerHTML = '';

            const comments = JSON.parse(localStorage.getItem(COMMENTS_KEY));
            if (!comments[articleId] || comments[articleId].length === 0) {
                container.innerHTML = '<p>暂无评论</p>';
                return;
            }

            comments[articleId].forEach(comment => {
                const commentEl = document.createElement('div');
                commentEl.className = 'comment';
                commentEl.innerHTML = `
            <div class="comment-header">
                <span class="comment-author">${comment.author}</span>
                <span class="comment-date">${new Date(comment.timestamp).toLocaleString()}</span>
            </div>
            <div class="comment-content">${comment.content}</div>
        `;
                container.appendChild(commentEl);
            });
        }

        // 收藏功能
        function toggleFavorite(articleId) {
            const user = getCurrentUser();
            if (!user) {
                alert('请先登录后再收藏');
                return false;
            }

            const favorites = JSON.parse(localStorage.getItem(FAVORITES_KEY));
            if (!favorites[user]) {
                favorites[user] = [];
            }

            const index = favorites[user].indexOf(articleId);
            if (index === -1) {
                favorites[user].push(articleId);
            } else {
                favorites[user].splice(index, 1);
            }

            localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));
            renderArticles(); // 更新文章列表
            return true;
        }

        // 检查是否已收藏
        function isFavorite(articleId) {
            const user = getCurrentUser();
            if (!user) return false;

            const favorites = JSON.parse(localStorage.getItem(FAVORITES_KEY));
            return favorites[user] && favorites[user].includes(articleId);
        }

        function openSnakeArticleModal(title, content, articleId) {
            const modal = document.getElementById('snake-article-modal');
            const titleElement = document.getElementById('snake-modal-article-title');
            const contentElement = document.getElementById('snake-modal-article-content');

            titleElement.textContent = title;
            contentElement.innerHTML = marked.parse(content || '') + `
        <div class="comments-section">
            <h3>评论</h3>
            <div id="comments-container-${articleId}"></div>
            <div class="comment-form">
                <textarea id="comment-input-${articleId}" placeholder="写下你的评论..."></textarea>
                <button class="luogu-btn submit-comment" data-article="${articleId}">提交评论</button>
            </div>
        </div>
    `;

            // 渲染评论
            renderComments(articleId);

            // 绑定评论提交事件
            document.querySelector(`.submit-comment[data-article="${articleId}"]`).addEventListener('click', function () {
                const content = document.getElementById(`comment-input-${articleId}`).value;
                if (addComment(articleId, content)) {
                    document.getElementById(`comment-input-${articleId}`).value = '';
                    renderComments(articleId);
                }
            });

            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeSnakeArticleModal() {
            document.getElementById('snake-article-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // 修改后的事件绑定
        document.querySelector('.snake-modal-close').onclick = closeSnakeArticleModal;

        window.addEventListener('click', function (event) {
            if (event.target === document.getElementById('snake-article-modal')) {
                closeSnakeArticleModal();
            }
        });

        document.addEventListener('keydown', function (event) {
            if (event.key === 'Escape') {
                closeSnakeArticleModal();
            }
        });

        // 侧边栏导航功能
        const sections = {
            'game-link': 'game-section',
            'algorithm-link': 'algorithm-section',
            'calendar-link': 'calendar-section',
            'roadmap-link': 'roadmap-section',
            'daily-link': 'daily-section',
            'notes-link': 'home-section',
            'article-link': 'article-section',
            'resources-link': 'resources-section',
            'favorites-link': 'favorites-section',
            'discussion-link': 'discussion-section'
        };

        Object.keys(sections).forEach(id => {
            document.getElementById(id).addEventListener('click', function () {
                // 隐藏所有部分
                document.querySelectorAll('.algorithm-section, #home-section, .calendar-section, .roadmap-section, .daily-section, .game-section, .weather-section, .article-section, .resources-section, .favorites-section, .discussion-section').forEach(section => {
                    section.classList.remove('active-section');
                });

                // 显示选中的部分
                const sectionToShow = sections[id];
                document.getElementById(sectionToShow).classList.add('active-section');

                // 根据部分加载相应内容
                if (id === 'algorithm-link') {
                    renderAlgorithmCards('sort');
                } else if (id === 'calendar-link') {
                    renderCalendarEvents('all');
                } else if (id === 'roadmap-link') {
                    renderRoadmapSteps();
                } else if (id === 'daily-link') {
                    renderDailyProblems();
                } else if (id === 'resources-link') {
                    renderLearningResources();
                }
            });
        });

        // 渲染收藏页面
        function renderFavorites() {
            const container = document.getElementById('favorites-container');
            container.innerHTML = '';

            const user = getCurrentUser();
            if (!user) {
                container.innerHTML = '<p>请先登录查看收藏</p>';
                return;
            }

            const favorites = JSON.parse(localStorage.getItem(FAVORITES_KEY))[user] || [];
            if (favorites.length === 0) {
                container.innerHTML = '<p>暂无收藏</p>';
                return;
            }

            const allArticles = [...officialArticles, ...JSON.parse(localStorage.getItem(ARTICLES_KEY))];

            favorites.forEach(articleId => {
                const article = allArticles.find(a => a.id === articleId);

                if (article) {
                    const isOfficial = articleId.startsWith('official-');
                    const card = document.createElement('div');
                    card.className = 'article-card';
                    card.innerHTML = `
                <h3>${article.title}</h3>
                <div class="article-meta">
                    <span class="article-category">${article.category}</span>
                    <span>发布于: ${new Date(article.timestamp).toLocaleString()}</span>
                    ${isOfficial ? '<span style="color: var(--highlight-color); margin-left: 10px;">(官方)</span>' : ''}
                </div>
                <div class="article-content">${article.content.substring(0, 100)}${article.content.length > 100 ? '...' : ''}</div>
                <div class="article-actions">
                    <button class="luogu-btn view-article-btn" data-id="${articleId}">查看</button>
                    <button class="luogu-btn remove-favorite-btn" data-id="${articleId}">取消收藏</button>
                </div>
            `;
                    container.appendChild(card);
                }
            });

            // 添加查看按钮事件
            document.querySelectorAll('.view-article-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const articleId = `article-${Date.now()}`;
                    const allArticles = [...officialArticles, ...JSON.parse(localStorage.getItem(ARTICLES_KEY))];
                    const article = allArticles.find(a => a.id === articleId);

                    if (article) {
                        openSnakeArticleModal(article.title, article.content, false, articleId);
                    }
                });
            });

            // 添加取消收藏按钮事件
            document.querySelectorAll('.remove-favorite-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const articleId = `article-${Date.now()}`;
                    const user = getCurrentUser();

                    if (user) {
                        const favorites = JSON.parse(localStorage.getItem(FAVORITES_KEY));
                        if (favorites[user]) {
                            const index = favorites[user].indexOf(articleId);
                            if (index !== -1) {
                                favorites[user].splice(index, 1);
                                localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));
                                renderFavorites();
                                renderArticles(); // 更新文章列表中的收藏状态
                            }
                        }
                    }
                });
            });
        }

        // 在侧边栏点击事件中添加
        document.getElementById('favorites-link').addEventListener('click', function () {
            // 隐藏所有部分
            document.querySelectorAll('.algorithm-section, #home-section, .calendar-section, .roadmap-section, .daily-section, .game-section, .weather-section, .article-section, .resources-section, .favorites-section').forEach(section => {
                section.classList.remove('active-section');
            });

            // 显示收藏部分
            document.getElementById('favorites-section').classList.add('active-section');
            renderFavorites();
        });

        // 文章数据存储
        const ARTICLES_KEY = 'snake_test_articles';

        // 官方文章数据
        const officialArticles = [
            {
                title: "Snake-test 使用指南",
                category: "官方",
                content: "## Snake-test 使用指南\n\n欢迎使用Snake-test平台！本指南将帮助您快速了解平台功能。\n\n### 主要功能\n1. **小游戏** - 提供多种编程相关小游戏\n2. **算法模板** - 常用算法代码模板库\n3. **竞赛日历** - 编程竞赛时间表\n4. **学习资源** - 精选编程学习资料\n\n### 注意事项\n- 请遵守平台使用规则\n- 定期备份您的重要文章\n- 遇到问题请联系管理员",
                timestamp: "NAN",
                id: "official-Snake-test 使用指南-NAN"
            },
            {
                title: "Snake 集团 N倍经验",
                category: "官方",
                content: "# $N$ 倍经验\n> 注意：虽然部分来自网络，但也不要给他人，仅[snake集团](https://www.luogu.com.cn/team/98666)成员使用，$\\color{red}请不要收藏文章和题单！$\n\n## 已做好的\n\n> $8$ 倍经验\n> > [$8$ 倍经验 - $1$](https://www.luogu.com.cn/training/726850)\n> >\n\n## 总目录\n\n> 有时间的可以帮忙搞一下，如有其他的或要帮忙整题单请私信。\n\n### 1.\n- [P1908 逆序对](https://www.luogu.com.cn/problem/P1908)\n- [P1116 车厢重组](https://www.luogu.com.cn/problem/P1116)\n- [P1774 最接近神的人](https://www.luogu.com.cn/problem/P1774)\n- [INVCNT - Inversion Count](https://www.luogu.com.cn/problem/SP6256)\n- [CODESPTB - Insertion Sort](https://www.luogu.com.cn/problem/SP9722)\n- [BUBBLESORT - Bubble Sort](https://www.luogu.com.cn/problem/SP25784)\n- [転倒数](https://www.luogu.com.cn/problem/AT_chokudai_S001_j)\n- [Ultra-QuickSort](https://www.luogu.com.cn/problem/UVA10810)\n- [Train Swapping](https://www.luogu.com.cn/problem/UVA299)\n- [Flip Sort](https://www.luogu.com.cn/problem/UVA10327)\n\n### 2.\n- [P1835 素数密度](https://www.luogu.com.cn/problem/P1835)\n- [Prime Distance](https://www.luogu.com.cn/problem/UVA10140)\n- [PRINT - Prime Intervals](https://www.luogu.com.cn/problem/SP503)\n- [PRIME1 - Prime Generator](https://www.luogu.com.cn/problem/SP2)\n- [P3383 【模板】线性筛素数](https://www.luogu.com.cn/problem/P3383)\n\n### 3.\n- [团队分组 Team them up!](https://www.luogu.com.cn/problem/UVA1627)\n- [P1285 队员分组](https://www.luogu.com.cn/problem/P1285)\n\n### 4.\n- [P1048 [NOIP2005 普及组] 采药](https://www.luogu.com.cn/problem/P1048)\n- [P2871 [USACO07DEC]Charm Bracelet S](https://www.luogu.com.cn/problem/P2871)\n\n### 5.\n- [P1616 疯狂的采药](https://www.luogu.com.cn/problem/P1616)\n- [P2722 [USACO3.1]总分 Score Inflation](https://www.luogu.com.cn/problem/P2722)\n\n### 6.\n- [P1390 公约数的和](https://www.luogu.com.cn/problem/P1390)\n- [P1447 [NOI2010] 能量采集](https://www.luogu.com.cn/problem/P1447)\n- [P2158 [SDOI2008] 仪仗队](https://www.luogu.com.cn/problem/P2158)\n- [P2398 GCD SUM](https://www.luogu.com.cn/problem/P2398)\n- [P2568 GCD](https://www.luogu.com.cn/problem/P2568)\n- [GCDEX - GCD Extreme](https://www.luogu.com.cn/problem/SP3871)\n- [GCDEX2 - GCD Extreme (hard)](https://www.luogu.com.cn/problem/SP19985)\n- [GCD](https://www.luogu.com.cn/problem/UVA11417)\n- [GCD - Extreme (I)](https://www.luogu.com.cn/problem/UVA11424)\n- [拿行李（极限版） GCD - Extreme (II)](https://www.luogu.com.cn/problem/UVA11426)\n- [P2389 电脑班的裁员](https://www.luogu.com.cn/problem/P2389)\n\n### 7.\n- [B2001 入门测试题目](https://www.luogu.com.cn/problem/B2001)\n- [P1001 A+B Problem](https://www.luogu.com.cn/problem/P1001)\n- [B2007 A + B 问题](https://www.luogu.com.cn/problem/B2007)\n- [A + B Strikes Back](https://www.luogu.com.cn/problem/CF409H)\n\n### 8.\n- [P1969 [NOIP2013 提高组] 积木大赛](https://www.luogu.com.cn/problem/P1969)\n- [P3078 [USACO13MAR]Poker Hands S](https://www.luogu.com.cn/problem/P3078)\n- [P5019 [NOIP2018 提高组] 铺设道路](https://www.luogu.com.cn/problem/P5019)\n\n### 9.\n- [P1150 Peter 的烟](https://www.luogu.com.cn/problem/P1150)\n- [Peter's Smokes](https://www.luogu.com.cn/problem/UVA10346)\n- [New Year Candles](https://www.luogu.com.cn/problem/CF379A)\n\n### 10.\n- [P1904 天际线](https://www.luogu.com.cn/problem/P1904)\n- [The Skyline Problem](https://www.luogu.com.cn/problem/UVA105)\n\n### 11.\n- [P1403 [AHOI2005]约数研究](https://www.luogu.com.cn/problem/P1403)\n- [DIVCNT1 - Counting Divisors](https://www.luogu.com.cn/problem/SP26073)\n\n### 12.\n- [P2023 [AHOI2009] 维护序列](https://www.luogu.com.cn/problem/P2023)\n- [P3373 【模板】线段树 2](https://www.luogu.com.cn/problem/P3373)\n\n### 13.\n- [P1212 [USACO1.4]铺放矩形块 Packing Rectangles](https://www.luogu.com.cn/problem/P1212)\n- [P5917 [IOI1995]铺放矩形块](https://www.luogu.com.cn/problem/P5917)\n\n### 14.\n- [Chat room](https://www.luogu.com.cn/problem/CF58A)\n- [Fake News (easy)](https://www.luogu.com.cn/problem/CF802G)\n- [CF](https://www.luogu.com.cn/problem/AT_codefestival_2016_qualC_a)\n- [Can you get AC?](https://www.luogu.com.cn/problem/AT_code_festival_2017_qualc_a)\n\n### 15.\n- [P2602 [ZJOI2010] 数字计数](https://www.luogu.com.cn/problem/P2602)\n- [P4999 烦人的数学作业](https://www.luogu.com.cn/problem/P4999)\n- [MDIGITS - Counting Digits](https://www.luogu.com.cn/problem/SP3928)\n- [PR003004 - Digit Sum](https://www.luogu.com.cn/problem/SP17247)\n- [P1836 数页码](https://www.luogu.com.cn/problem/P1836)\n- [统计问题 The Counting Problem](https://www.luogu.com.cn/problem/UVA1640)\n\n### 16.\n- [P6476 [NOI Online #2 提高组] 涂色游戏](https://www.luogu.com.cn/problem/P6476)\n- [Infinite Fence](https://www.luogu.com.cn/problem/CF1260C)\n\n### 17.\n- [P2627 [USACO11OPEN]Mowing the Lawn G](https://www.luogu.com.cn/problem/P2627)\n- [P2034 选择数字](https://www.luogu.com.cn/problem/P2034)\n\n### 18.\n- [P7883 平面最近点对（加强加强版）](https://www.luogu.com.cn/problem/P7883)\n- [P1429 平面最近点对（加强版）](https://www.luogu.com.cn/problem/P1429)\n- [P1257 平面上的最接近点对](https://www.luogu.com.cn/problem/P1257)\n\n### 19.\n- [P2440 木材加工](https://www.luogu.com.cn/problem/P2440)\n- [P1577 切绳子](https://www.luogu.com.cn/problem/P1577)**(输入时先×100)**\n\n### 20.\n- [Spreading the Wealth](https://www.luogu.com.cn/problem/UVA11300)\n- [P1031 [NOIP2002 提高组] 均分纸牌](https://www.luogu.com.cn/problem/P1031)\n- [P3051 [USACO12MAR]Haybale Restacking G](https://www.luogu.com.cn/problem/P3051)\n- [P2512 [HAOI2008]糖果传递](https://www.luogu.com.cn/problem/P2512)\n- [P4016 负载平衡问题](https://www.luogu.com.cn/problem/P4016)\n- [P2125 图书馆书架上的书](https://www.luogu.com.cn/problem/P2125)\n- [RESTACK - Restacking haybales 2012](https://www.luogu.com.cn/problem/SP11117)\n\n### 21.\n- [P3902 递增](https://www.luogu.com.cn/problem/P3902)\n- [LIS](https://www.luogu.com.cn/problem/AT_chokudai_S001_h)\n\n### 22.\n- [P1090 [NOIP2004 提高组] 合并果子 / [USACO06NOV] Fence Repair G](https://www.luogu.com.cn/problem/P1090)\n- [P6033 [NOIP2004 提高组] 合并果子 加强版](https://www.luogu.com.cn/problem/P6033)\n\n### 23.\n- [P1114 “非常男女”计划](https://www.luogu.com.cn/problem/P1114)\n- [P2697 宝石串](https://www.luogu.com.cn/problem/P2697)\n- [Balanced Substring](https://www.luogu.com.cn/problem/CF873B)\n\n### 24.\n- [P1596 [USACO10OCT]Lake Counting S](https://www.luogu.com.cn/problem/P1596)\n- [油田 Oil Deposits](https://www.luogu.com.cn/problem/UVA572)\n\n### 25.\n- [P1194 买礼物](https://www.luogu.com.cn/problem/P1194)\n- [P1546 [USACO3.1]最短网络 Agri-Net](https://www.luogu.com.cn/problem/P1546)\n\n### 26.\n- [P1507 NASA的食物计划](https://www.luogu.com.cn/problem/P1507)\n- [P1910 L国的战斗之间谍](https://www.luogu.com.cn/problem/P1910)\n- [P1855 榨取kkksc03](https://www.luogu.com.cn/problem/P1855)\n- [P1794 装备运输](https://www.luogu.com.cn/problem/P1794)\n\n### 27.\n- [P2714 四元组统计](https://www.luogu.com.cn/problem/P2714)\n- [MSKYCODE - Sky Code](https://www.luogu.com.cn/problem/SP4191)\n\n### 28.\n- [BACKUP - Backup Files](https://www.luogu.com.cn/problem/SP1553)\n- [P3620 [APIO/CTSC2007] 数据备份](https://www.luogu.com.cn/problem/P3620)\n\n### 29.\n- [P3817 小A的糖果](https://www.luogu.com.cn/problem/P3817)\n- [[ABC048C] Boxes and Candies](https://www.luogu.com.cn/problem/AT_arc064_a)\n\n### 30.\n- [P1817 棋盘染色](https://www.luogu.com.cn/problem/P1817)\n- [P4537 [CQOI2007]矩形](https://www.luogu.com.cn/problem/P4537)\n- [P1790 矩形分割](https://www.luogu.com.cn/problem/P1790)\n\n### 31.\n- [P1404 平均数 ](https://www.luogu.com.cn/problem/P1404)\n- [平均值 Average](https://www.luogu.com.cn/problem/UVA1451)\n- [P7795 [COCI2014-2015#7] PROSJEK](https://www.luogu.com.cn/problem/P7795)\n\n### 32.\n- [P8586 星环防御工事](https://www.luogu.com.cn/problem/P8586)\n- [Valera and Fruits](https://www.luogu.com.cn/problem/CF441B)\n\n### 33.\n- [P2884 [USACO07MAR]Monthly Expense S](https://www.luogu.com.cn/problem/P2884)\n- [P1182 数列分段 Section II](https://www.luogu.com.cn/problem/P1182)\n\n### 34.\n- [P8638 [蓝桥杯 2016 省 A] 密码脱落](https://www.luogu.com.cn/problem/P8638)\n- [P1435 [IOI2000] 回文字串 / [蓝桥杯 2016 省] 密码脱落](https://www.luogu.com.cn/problem/P1435)\n\n### 35.\n- [P1256 显示图像](https://www.luogu.com.cn/problem/P1256)\n- [P2335 [SDOI2005]位图](https://www.luogu.com.cn/problem/P2335)\n\n### 36.\n- [P1250 种树](https://www.luogu.com.cn/problem/P1250)\n- [P1645 序列](https://www.luogu.com.cn/problem/P1645)\n- [P1986 元旦晚会](https://www.luogu.com.cn/problem/P1986)\n- [Intervals](https://www.luogu.com.cn/problem/UVA1723)\n- [INTERVAL - Intervals](https://www.luogu.com.cn/problem/SP116)\n\n### 37.\n- [P3396 哈希冲突](https://www.luogu.com.cn/problem/P3396)\n- [Remainder Problem](https://www.luogu.com.cn/problem/CF1207F)\n\n### 38.\n- [P1893 山峰暸望](https://www.luogu.com.cn/problem/P1893)\n- [P6181 [USACO10OPEN]Mountain Watching S\n](https://www.luogu.com.cn/problem/P6181)\n\n### 39.\n- [P4279 [SHOI2008] 小约翰的游戏](https://www.luogu.com.cn/problem/P4279)\n- [P2197 【模板】nim 游戏](https://www.luogu.com.cn/problem/P2197)\n- [John](https://www.luogu.com.cn/problem/UVA1566)\n\n### 40.\n- [Electricity](https://www.luogu.com.cn/problem/UVA12148)\n- [SAMER08E - Electricity](https://www.luogu.com.cn/problem/SP3409)\n\n### 41.\n- [小木棍 Sticks](https://www.luogu.com.cn/problem/UVA307)\n- [P1120 小木棍](https://www.luogu.com.cn/problem/P1120)\n\n### 42.\n- [P4331 [BalticOI 2004] Sequence 数字序列](https://www.luogu.com.cn/problem/P4331)\n- [Sequence](https://www.luogu.com.cn/problem/CF13C)\n- [P4597 序列 sequence](https://www.luogu.com.cn/problem/P4597)\n- [Sonya and Problem Wihtout a Legend](https://www.luogu.com.cn/problem/CF713C)\n- [P2893 [USACO08FEB] Making the Grade G](https://www.luogu.com.cn/problem/P2893)\n\n### 43.\n- [B2055 均值](https://www.luogu.com.cn/problem/B2055)\n- [B2054 求平均年龄](https://www.luogu.com.cn/problem/B2054)\n- [B2056 求整数的和与均值\n](https://www.luogu.com.cn/problem/B2056)\n\n### 44.\n- [CTGAME - City Game](https://www.luogu.com.cn/problem/SP277)\n- [City Game](https://www.luogu.com.cn/problem/UVA1330)\n- [P4147 玉蟾宫\n](https://www.luogu.com.cn/problem/P4147)\n- [P5943 [POI2002] 最大的园地\n](https://www.luogu.com.cn/problem/P5943)\n\n### 45.\n- [P8218 【深进1.例1】求区间和](https://www.luogu.com.cn/problem/P8218)\n- [B3612 【深进1.例1】求区间和](https://www.luogu.com.cn/problem/B3612)\n\n### 46.\n- [P5146 最大差值](https://www.luogu.com.cn/problem/P5146)\n- [Open Credit System](https://www.luogu.com.cn/problem/UVA11078)\n\n### 47.\n- [P2574 XOR的艺术](https://www.luogu.com.cn/problem/P2574)\n- [P3870 [TJOI2009] 开关](https://www.luogu.com.cn/problem/P3870)\n- [LITE - Light Switching](https://www.luogu.com.cn/problem/SP7259)\n- [P2846 [USACO08NOV] Light Switching G](https://www.luogu.com.cn/problem/P2846)\n- [P5057 [CQOI2006] 简单题](https://www.luogu.com.cn/problem/P5057)\n\n### 48.\n- [Built?](https://www.luogu.com.cn/problem/AT_arc076_b)\n- [P8074 [COCI 2009/2010 #7] SVEMIR](https://www.luogu.com.cn/problem/P8074)\n\n### 49.\n- [P2665 [USACO08FEB] Game of Lines S](https://www.luogu.com.cn/problem/P2665)\n- [LINES - Game of Lines](https://www.luogu.com.cn/problem/SP3184)\n\n### 50.\n- [P4170 [CQOI2007] 涂色](https://www.luogu.com.cn/problem/P4170)\n- [Clear the String](https://www.luogu.com.cn/problem/CF1132F)",
                timestamp: "NAN",
                id: "official-Snake 集团 N倍经验-NAN"
            },
        ];

        // 初始化文章数据
        if (!localStorage.getItem(ARTICLES_KEY)) {
            localStorage.setItem(ARTICLES_KEY, JSON.stringify([]));
        }

        // DOM元素
        const articleSection = document.getElementById('article-section');
        const newArticleBtn = document.getElementById('new-article-btn');
        const viewArticlesBtn = document.getElementById('view-articles-btn');
        const articleEditor = document.getElementById('article-editor');
        const articleList = document.getElementById('article-list');
        const articleForm = document.getElementById('article-form');
        const backToEditorBtn = document.getElementById('back-to-editor');
        const cancelEditBtn = document.getElementById('cancel-edit');

        // 显示文章编辑器
        function showArticleEditor() {
            articleEditor.classList.add('active-section');
            articleList.classList.remove('active-section');
            articleForm.reset();
        }

        // 显示文章列表
        function showArticleList() {
            articleEditor.classList.remove('active-section');
            articleList.classList.add('active-section');
            renderArticles();
        }

        // 渲染文章列表
        function renderArticles() {
            const userArticles = JSON.parse(localStorage.getItem(ARTICLES_KEY)) || [];
            const allArticles = [...officialArticles, ...userArticles];
            const container = document.getElementById('articles-container');
            container.innerHTML = '';

            allArticles.forEach(article => {
                const isOfficial = article.category === "官方";
                const articleId = article.id;

                const card = document.createElement('div');
                card.className = 'article-card';
                if (isOfficial) card.classList.add('official');

                card.innerHTML = `
            <h3>${article.title}</h3>
            <div class="article-meta">
                <span class="article-category">${article.category}</span>
                <span>发布于: ${new Date(article.timestamp).toLocaleString()}</span>
                ${isOfficial ? '<span class="official-badge">官方</span>' : ''}
            </div>
            <div class="article-content">${article.content.substring(0, 100)}${article.content.length > 100 ? '...' : ''}</div>
            <div class="article-actions">
                <button class="luogu-btn view-article-btn" data-id="${articleId}">查看</button>
                ${!isOfficial ? `
                <button class="luogu-btn edit-article-btn" data-id="${articleId}">编辑</button>
                <button class="luogu-btn delete-article-btn" data-id="${articleId}">删除</button>
                ` : ''}
                <button class="luogu-btn favorite-btn ${isFavorite(articleId) ? 'active' : ''}" data-id="${articleId}">
                    ${isFavorite(articleId) ? '取消收藏' : '收藏'}
                </button>
            </div>
        `;

                container.appendChild(card);
            });

            // 绑定事件
            bindArticleEvents();
        }

        // 绑定文章事件
        function bindArticleEvents() {
            // 查看按钮
            document.querySelectorAll('.view-article-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const articleId = this.getAttribute('data-id');
                    const allArticles = [...officialArticles, ...JSON.parse(localStorage.getItem(ARTICLES_KEY))];
                    const article = allArticles.find(a => a.id === articleId);
                    if (article) {
                        openSnakeArticleModal(article.title, article.content, articleId);
                    }
                });
            });

            // 收藏按钮
            document.querySelectorAll('.favorite-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const articleId = this.getAttribute('data-id');
                    if (toggleFavorite(articleId)) {
                        renderArticles(); // 更新文章列表
                    }
                });
            });

            // 编辑按钮
            document.querySelectorAll('.edit-article-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const articleId = this.getAttribute('data-id');
                    const articles = JSON.parse(localStorage.getItem(ARTICLES_KEY));
                    const article = articles.find(a => a.id === articleId);
                    if (article) {
                        document.getElementById('article-title').value = article.title;
                        document.getElementById('article-category').value = article.category;
                        document.getElementById('article-content').value = article.content;

                        // 标记当前正在编辑的文章索引
                        document.getElementById('article-form').dataset.editingId = articleId;

                        showArticleEditor();
                    }
                });
            });

            // 删除按钮
            document.querySelectorAll('.delete-article-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const articleId = this.getAttribute('data-id');
                    if (confirm('确定要删除这篇文章吗？')) {
                        const articles = JSON.parse(localStorage.getItem(ARTICLES_KEY));
                        const updatedArticles = articles.filter(a => a.id !== articleId);
                        localStorage.setItem(ARTICLES_KEY, JSON.stringify(updatedArticles));
                        renderArticles(); // 更新文章列表
                    }
                });
            });
        }

        // 修改openSnakeArticleModal调用
        function viewArticle(index) {
            const articles = JSON.parse(localStorage.getItem(ARTICLES_KEY));
            const article = articles[index];
            const articleId = `article-${Date.now()}`;
            openSnakeArticleModal(article.title, article.content, false, articleId);
        }

        /**
 * 打开文章模态框（支持模态框和新标签页两种模式）
 * @param {string} title - 文章标题
 * @param {string} content - Markdown格式内容
 * @param {boolean} [inNewTab=false] - 是否在新标签页打开
 */
        function openSnakeArticleModal(title, content, inNewTab = false) {
            if (inNewTab) {
                // 新标签页模式
                const newWindow = window.open('', '_blank');
                const htmlDoc = `<!DOCTYPE html>
        <html lang="zh-CN">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>${escapeHtml(title)}</title>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
            <style>
                /* 保持原有样式 */
            </style>
        </head>
        <body>
            <article>
                <h1>${escapeHtml(title)}</h1>
                <div id="article-content"></div>
            </article>

            <script src="https://cdn.jsdelivr.net/npm/marked@4.2.12/marked.min.js"><\/script>
            <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"><\/script>
            <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"><\/script>
            
            <script>
                try {
                    const content = \`${escapeJsString(content)}\`;
                    
                    marked.setOptions({
                        breaks: false,
                        gfm: true
                    });
                    
                    document.getElementById('article-content').innerHTML = marked.parse(content);
                    
                    renderMathInElement(document.body, {
                        delimiters: [
                            { left: '$$', right: '$$', display: true },
                            { left: '$', right: '$', display: false },
                            { left: '\\\\(', right: '\\\\)', display: false },
                            { left: '\\\\[', right: '\\\\]', display: true }
                        ],
                        throwOnError: false,
                        output: 'mathml'
                    });
                    
                } catch(e) {
                    document.getElementById('article-content').innerHTML = 
                        '<div style="color:red;padding:1em;border:1px solid #f00;">' +
                        '内容渲染出错: ' + escapeHtml(e.message) + '</div>';
                    console.error('文章渲染错误:', e);
                }
            <\/script>
        </body>
        </html>`;

                newWindow.document.open();
                newWindow.document.write(htmlDoc);
                renderMathInElement(htmlDoc.document.body, {
                    delimiters: [
                        { left: '$$', right: '$$', display: true },
                        { left: '$', right: '$', display: false },
                        { left: '\\\\(', right: '\\\\)', display: false },
                        { left: '\\\\[', right: '\\\\]', display: true }
                    ],
                    throwOnError: false,
                    output: 'mathml'
                });
                newWindow.document.close();
            } else {
                // 模态框模式
                const modal = document.getElementById('snake-article-modal');
                const titleElement = document.getElementById('snake-modal-article-title');
                const contentElement = document.getElementById('snake-modal-article-content');

                contentElement.innerHTML = marked.parse(content || '') + `
        <div class="comments-section">
            <h3>评论</h3>
            <div id="comments-container-${articleId}"></div>
            <div class="comment-form">
                <textarea id="comment-input-${articleId}" placeholder="写下你的评论..."></textarea>
                <button class="luogu-btn submit-comment" data-article="${articleId}">提交评论</button>
            </div>
        </div>
    `;// 在模态框内容中添加评论区域

                // 渲染评论
                renderComments(articleId);

                // 添加评论提交事件
                document.querySelector(`.submit-comment[data-article="${articleId}"]`).addEventListener('click', function () {
                    const content = document.getElementById(`comment-input-${articleId}`).value;
                    if (addComment(articleId, content)) {
                        document.getElementById(`comment-input-${articleId}`).value = '';
                        renderComments(articleId);
                    }
                });


                titleElement.textContent = title;
                contentElement.innerHTML = marked.parse(content || '');

                renderMathInElement(contentElement, {
                    delimiters: [
                        { left: '$$', right: '$$', display: true },
                        { left: '$', right: '$', display: false }
                    ],
                    throwOnError: false
                });

                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }

        // 关闭模态框的函数
        function closeSnakeArticleModal() {
            document.getElementById('snake-article-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // 辅助函数：转义HTML特殊字符
        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // 辅助函数：转义JavaScript字符串中的特殊字符
        function escapeJsString(str) {
            return str
                .replace(/\\/g, '\\\\')
                .replace(/`/g, '\\`')
                .replace(/\$/g, '\\$')
                .replace(/\n/g, '\\n')
                .replace(/\r/g, '\\r');
        }

        // 转义HTML特殊字符
        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // 转义JavaScript字符串中的特殊字符
        function escapeJsString(str) {
            return str
                .replace(/\\/g, '\\\\')
                .replace(/`/g, '\\`')
                .replace(/\$/g, '\\$')
                .replace(/\n/g, '\\n')
                .replace(/\r/g, '\\r');
        }

        /**
         * 关闭文章模态框
         */
        function closeSnakeArticleModal() {
            document.getElementById('snake-article-modal').style.display = 'none';
            document.body.style.overflow = 'auto'; // 恢复滚动
        }

        // 绑定关闭事件
        document.querySelector('.snake-modal-close').addEventListener('click', closeSnakeArticleModal);
        window.addEventListener('click', (event) => {
            if (event.target === document.getElementById('snake-article-modal')) {
                closeSnakeArticleModal();
            }
        });
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                closeSnakeArticleModal();
            }
        });

        // 编辑文章
        function editArticle(index) {
            const articles = JSON.parse(localStorage.getItem(ARTICLES_KEY));
            const article = articles[index];

            document.getElementById('article-title').value = article.title;
            document.getElementById('article-category').value = article.category;
            document.getElementById('article-content').value = article.content;

            // 标记当前正在编辑的文章索引
            articleForm.dataset.editingIndex = index;

            showArticleEditor();
        }

        // 删除文章
        function deleteArticle(index) {
            if (confirm('确定要删除这篇文章吗？')) {
                const articles = JSON.parse(localStorage.getItem(ARTICLES_KEY));
                articles.splice(index, 1);
                localStorage.setItem(ARTICLES_KEY, JSON.stringify(articles));
                renderArticles();
            }
        }

        // 提交文章表单
        articleForm.addEventListener('submit', function (e) {
            e.preventDefault();

            const title = document.getElementById('article-title').value;
            const category = document.getElementById('article-category').value;
            const content = window.articleEditor.value();

            const articles = JSON.parse(localStorage.getItem(ARTICLES_KEY)) || [];

            if (this.dataset.editingIndex !== undefined) {
                // 编辑现有文章
                const index = parseInt(this.dataset.editingIndex);
                articles[index] = {
                    id: articles[index].id, // 保持原有ID不变
                    title,
                    category,
                    content,
                    timestamp: articles[index].timestamp
                };
            } else {
                // 添加新文章
                const timestamp = new Date().toISOString();
                // 在保存文章时生成固定ID
                articles.push({
                    id: `article-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`, // 唯一 ID
                    title,
                    category,
                    content,
                    timestamp
                });
            }

            localStorage.setItem(ARTICLES_KEY, JSON.stringify(articles));
            showArticleList();
        });

        // 修改官方文章的 ID 格式
        officialArticles.forEach(article => {
            if (!article.id.startsWith('article-')) {
                article.id = `article-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
            }
        });

        // 将修改后的官方文章存储到 localStorage（如果需要）
        localStorage.setItem('officialArticles', JSON.stringify(officialArticles));

        // 按钮事件
        newArticleBtn.addEventListener('click', showArticleEditor);
        viewArticlesBtn.addEventListener('click', showArticleList);
        backToEditorBtn.addEventListener('click', showArticleEditor);
        cancelEditBtn.addEventListener('click', function () {
            if (articleForm.dataset.editingIndex !== undefined) {
                delete articleForm.dataset.editingIndex;
            }
            showArticleList();
        });

        // DOMContentLoaded事件添加代码
        document.addEventListener('DOMContentLoaded', function () {
            // 配置marked和highlight.js
            marked.setOptions({
                highlight: function (code, lang) {
                    if (lang && hljs.getLanguage(lang)) {
                        return hljs.highlight(lang, code).value;
                    }
                    return hljs.highlightAuto(code).value;
                },
                breaks: false,
                gfm: true
            });

            // 配置Katex
            const katexOptions = {
                delimiters: [
                    { left: '$$', right: '$$', display: true },
                    { left: '$', right: '$', display: false },
                    { left: '\\(', right: '\\)', display: false },
                    { left: '\\[', right: '\\]', display: true }
                ],
                throwOnError: false
            };

            // 初始化EasyMDE编辑器
            let easyMDE = new EasyMDE({
                element: document.getElementById('article-content'),
                autoDownloadFontAwesome: false,
                spellChecker: false,
                forceSync: true,
                placeholder: "输入文章内容，支持Markdown和LaTeX数学公式...",
                toolbar: [
                    'bold', 'italic', 'heading', '|',
                    'quote', 'code', '|',
                    'unordered-list', 'ordered-list', '|',
                    'link', 'image', 'table', '|',
                    'preview', 'side-by-side', 'fullscreen', '|',
                    'guide'
                ],
                sideBySideFullscreen: false,
                status: false,
                renderingConfig: {
                    singleLineBreaks: false,
                    codeSyntaxHighlighting: true
                }
            });

            // 保存编辑器实例以便后续使用
            window.articleEditor = easyMDE;

            // 修改文章查看逻辑以支持Markdown渲染
            function viewArticle(index) {
                const articles = JSON.parse(localStorage.getItem(ARTICLES_KEY));
                const article = articles[index];

                // 填充模态框内容
                document.getElementById('modal-article-title').textContent = article.title;
                document.getElementById('modal-article-category').textContent = article.category;
                document.getElementById('modal-article-date').textContent = '发布于: ' +
                    new Date(article.timestamp).toLocaleString();

                // 渲染Markdown内容
                const preview = document.getElementById('modal-article-content');
                preview.innerHTML = marked(article.content);
                renderMathInElement(preview, katexOptions);

                // 显示模态框
                document.getElementById('article-modal').style.display = 'block';
                openSnakeArticleModal(article.title, article.content);
            }

            // 关闭文章模态框
            document.querySelector('#article-modal .close-btn').addEventListener('click', function () {
                document.getElementById('article-modal').style.display = 'none';
            });

            // 点击模态框外部关闭
            document.getElementById('article-modal').addEventListener('click', function (e) {
                if (e.target === this) {
                    this.style.display = 'none';
                }
            });

            // 修改editArticle函数以使用编辑器
            function editArticle(index) {
                const articles = JSON.parse(localStorage.getItem(ARTICLES_KEY));
                const article = articles[index];

                document.getElementById('article-title').value = article.title;
                document.getElementById('article-category').value = article.category;

                // 设置编辑器内容
                if (window.articleEditor) {
                    window.articleEditor.value(article.content);
                }

                // 标记当前正在编辑的文章索引
                articleForm.dataset.editingIndex = index;

                showArticleEditor();
            }
        });

        // 辅助函数：动态加载JS
        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }

        // 初始化显示编辑器
        showArticleEditor();

        // 算法模板库数据
        const algorithmTemplates = {
            sort: [
                {
                    title: "快速排序",
                    desc: "时间复杂度O(nlogn)的经典排序算法",
                    code: `void quickSort(int arr[], int left, int right) {
    if (left >= right) return;
    int i = left, j = right, pivot = arr[left];
    while (i < j) {
        while (i < j && arr[j] >= pivot) j--;
        if (i < j) arr[i++] = arr[j];
        while (i < j && arr[i] <= pivot) i++;
        if (i < j) arr[j--] = arr[i];
    }
    arr[i] = pivot;
    quickSort(arr, left, i - 1);
    quickSort(arr, i + 1, right);
}`
                },
                {
                    title: "归并排序",
                    desc: "稳定排序算法，时间复杂度O(nlogn)",
                    code: `void mergeSort(int arr[], int temp[], int left, int right) {
    if (left >= right) return;
    int mid = (left + right) / 2;
    mergeSort(arr, temp, left, mid);
    mergeSort(arr, temp, mid + 1, right);
    
    int i = left, j = mid + 1, k = left;
    while (i <= mid && j <= right) {
        if (arr[i] <= arr[j]) temp[k++] = arr[i++];
        else temp[k++] = arr[j++];
    }
    while (i <= mid) temp[k++] = arr[i++];
    while (j <= right) temp[k++] = arr[j++];
    for (i = left; i <= right; i++) arr[i] = temp[i];
}`
                }
            ],
            search: [
                {
                    title: "二分查找",
                    desc: "在有序数组中查找元素的O(logn)算法",
                    code: `int binarySearch(int arr[], int n, int target) {
    int left = 0, right = n - 1;
    while (left <= right) {
        int mid = left + (right - left) / 2;
        if (arr[mid] == target) return mid;
        if (arr[mid] < target) left = mid + 1;
        else right = mid - 1;
    }
    return -1;
}`
                },
                {
                    title: "DFS深度优先搜索",
                    desc: "用于树或图的遍历",
                    code: `void dfs(int node, vector<vector<int>>& graph, vector<bool>& visited) {
    visited[node] = true;
    for (int neighbor : graph[node]) {
        if (!visited[neighbor]) {
            dfs(neighbor, graph, visited);
        }
    }
}`
                }
            ],
            graph: [
                {
                    title: "Dijkstra算法",
                    desc: "单源最短路径算法，适用于无负权边",
                    code: `void dijkstra(int start, vector<vector<pair<int, int>>>& graph, vector<int>& dist) {
    priority_queue<pair<int, int>, vector<pair<int, int>>, greater<pair<int, int>>> pq;
    dist[start] = 0;
    pq.push({0, start});
    
    while (!pq.empty()) {
        auto [d, u] = pq.top(); pq.pop();
        if (d > dist[u]) continue;
        for (auto [v, w] : graph[u]) {
            if (dist[v] > dist[u] + w) {
                dist[v] = dist[u] + w;
                pq.push({dist[v], v});
            }
        }
    }
}`
                },
                {
                    title: "Kruskal算法",
                    desc: "最小生成树算法，使用并查集",
                    code: `struct Edge {
    int u, v, w;
    bool operator<(const Edge& other) const {
        return w < other.w;
    }
};

int find(vector<int>& parent, int x) {
    if (parent[x] != x) parent[x] = find(parent, parent[x]);
    return parent[x];
}

int kruskal(vector<Edge>& edges, int n) {
    sort(edges.begin(), edges.end());
    vector<int> parent(n);
    for (int i = 0; i < n; i++) parent[i] = i;
    
    int total = 0, count = 0;
    for (auto [u, v, w] : edges) {
        int rootU = find(parent, u), rootV = find(parent, v);
        if (rootU != rootV) {
            parent[rootU] = rootV;
            total += w;
            if (++count == n - 1) break;
        }
    }
    return total;
}`
                }
            ],
            dp: [
                {
                    title: "0-1背包问题",
                    desc: "经典的动态规划问题",
                    code: `int knapsack(vector<int>& weights, vector<int>& values, int capacity) {
    int n = weights.size();
    vector<vector<int>> dp(n + 1, vector<int>(capacity + 1, 0));
    
    for (int i = 1; i <= n; i++) {
        for (int j = 1; j <= capacity; j++) {
            if (weights[i-1] > j) {
                dp[i][j] = dp[i-1][j];
            } else {
                dp[i][j] = max(dp[i-1][j], dp[i-1][j-weights[i-1]] + values[i-1]);
            }
        }
    }
    return dp[n][capacity];
}`
                },
                {
                    title: "最长公共子序列",
                    desc: "LCS问题，动态规划解法",
                    code: `int longestCommonSubsequence(string text1, string text2) {
    int m = text1.size(), n = text2.size();
    vector<vector<int>> dp(m + 1, vector<int>(n + 1, 0));
    
    for (int i = 1; i <= m; i++) {
        for (int j = 1; j <= n; j++) {
            if (text1[i-1] == text2[j-1]) {
                dp[i][j] = dp[i-1][j-1] + 1;
            } else {
                dp[i][j] = max(dp[i-1][j], dp[i][j-1]);
            }
        }
    }
    return dp[m][n];
}`
                }
            ],
            math: [
                {
                    title: "快速幂",
                    desc: "高效计算幂次的方法",
                    code: `long long fastPow(long long base, long long exp, long long mod) {
    long long result = 1;
    while (exp > 0) {
        if (exp % 2 == 1) {
            result = (result * base) % mod;
        }
        base = (base * base) % mod;
        exp /= 2;
    }
    return result;
}`
                },
                {
                    title: "欧几里得算法",
                    desc: "计算最大公约数",
                    code: `int gcd(int a, int b) {
    while (b != 0) {
        int temp = a % b;
        a = b;
        b = temp;
    }
    return a;
}`
                }
            ]
        };

        const learningResources = [
            {
                title: "Codecademy",
                desc: "交互式编程学习平台，适合初学者。",
                link: "https://www.codecademy.com/"
            },
            {
                title: "LeetCode",
                desc: "刷题平台，提升算法能力。",
                link: "https://leetcode.com/"
            },
            {
                title: "GeeksforGeeks",
                desc: "全面的编程教程和面试准备资源。",
                link: "https://www.geeksforgeeks.org/"
            },
            {
                title: "FreeCodeCamp",
                desc: "免费编程课程，涵盖前端、后端和数据分析。",
                link: "https://www.freecodecamp.org/"
            },
            {
                title: "CS50",
                desc: "哈佛大学的计算机科学入门课程。",
                link: "https://cs50.harvard.edu/"
            }
        ];

        // 竞赛日历数据
        const programmingContests = [
            {
                title: "洛谷Rated团队公开赛",
                date: "不定期",
                platform: "luogu",
                desc: "洛谷举办的编程比赛，适合各个水平的选手参加",
                link: "https://www.luogu.com.cn/contest/"
            },
            {
                title: "洛谷月赛",
                date: "不定期",
                platform: "luogu",
                desc: "洛谷举办的编程比赛，适合各个水平的选手参加",
                link: "https://www.luogu.com.cn/contest/"
            },
            {
                title: "洛谷算法基础赛",
                date: "不定期",
                platform: "luogu",
                desc: "洛谷举办的编程比赛，适合各个水平的选手参加",
                link: "https://www.luogu.com.cn/contest/"
            },
            {
                title: "洛谷入门赛",
                date: "不定期",
                platform: "luogu",
                desc: "洛谷举办的编程比赛，适合初学选手参加",
                link: "https://www.luogu.com.cn/contest/"
            },
            {
                title: "洛谷基础赛",
                date: "不定期",
                platform: "luogu",
                desc: "洛谷举办的编程比赛，适合各个水平的选手参加",
                link: "https://www.luogu.com.cn/contest/"
            },
            {
                title: "梦熊洛谷同步赛",
                date: "不定期",
                platform: "luogu",
                desc: "洛谷上梦熊举办的编程比赛，适合各个水平的选手参加",
                link: "https://www.luogu.com.cn/contest/"
            },
            {
                title: "Codeforces Round",
                date: "待查",
                platform: "codeforces",
                desc: "Codeforces常规比赛",
                link: "https://codeforces.com/contests"
            },
            {
                title: "AtCoder Beginner Contest",
                date: "每周六晚8:00~9:40",
                platform: "atcoder",
                desc: "AtCoder面向初学者的比赛，适合算法入门选手",
                link: "https://atcoder.jp/contests/"
            },
            {
                title: "LeetCode Weekly Contest",
                date: "待查",
                platform: "leetcode",
                desc: "LeetCode每周算法竞赛，包含4道题目",
                link: "https://leetcode.com/contest/"
            },
        ];

        // 学习路线数据
        const learningRoadmap = [
            {
                title: "编程基础",
                level: "beginner",
                desc: "学习基本的编程概念和语法，掌握变量、循环、条件语句等",
                resources: "推荐资源: 《啊哈C语言》, Codecademy Python课程"
            },
            {
                title: "数据结构入门",
                level: "beginner",
                desc: "学习数组、链表、栈、队列等基本数据结构",
                resources: "推荐资源: 《算法图解》, LeetCode探索卡片"
            },
            {
                title: "算法基础",
                level: "intermediate",
                desc: "掌握排序、搜索、递归等基本算法",
                resources: "推荐资源: 《算法第四版》, 洛谷官方题单"
            },
            {
                title: "动态规划入门",
                level: "intermediate",
                desc: "理解动态规划的基本思想，学习经典DP问题",
                resources: "推荐资源: 《算法导论》动态规划章节, LeetCode DP专题"
            },
            {
                title: "图论基础",
                level: "intermediate",
                desc: "学习图的表示方法、遍历算法和最短路径问题",
                resources: "推荐资源: 《挑战程序设计竞赛》图论章节, Codeforces EDU"
            },
            {
                title: "高级数据结构",
                level: "advanced",
                desc: "学习树状数组、线段树、平衡树等高级数据结构",
                resources: "推荐资源: 《算法竞赛进阶指南》, OI Wiki"
            },
            {
                title: "复杂算法设计",
                level: "advanced",
                desc: "学习网络流、计算几何、字符串匹配等高级算法",
                resources: "推荐资源: 《算法艺术与信息学竞赛》, TopCoder教程"
            }
        ];

        // 每日一题数据
        const dailyProblems = [
            {
                title: "P1119 灾后重建",
                difficulty: "easy",
                desc: "灾后重建计划，需要根据道路修复情况计算最短路径。",
                link: "https://www.luogu.com.cn/problem/P1119",
                tags: ["最短路"]
            },
            {
                title: "P1340 贪吃的九头龙",
                difficulty: "easy",
                desc: "计算九头龙从起点到终点的最短路径。",
                link: "https://www.luogu.com.cn/problem/P1340",
                tags: ["最短路"]
            },
            {
                title: "P1363 幻想迷宫",
                difficulty: "easy",
                desc: "在幻想迷宫中找到从起点到终点的最短路径。",
                link: "https://www.luogu.com.cn/problem/P1363",
                tags: ["最短路"]
            },
            {
                title: "P1462 通往奥格瑞玛的道路",
                difficulty: "easy",
                desc: "计算从起点到奥格瑞玛的最短路径。",
                link: "https://www.luogu.com.cn/problem/P1462",
                tags: ["最短路"]
            },
            {
                title: "P1514 引水入城",
                difficulty: "easy",
                desc: "通过修建管道引水入城，计算最小花费。",
                link: "https://www.luogu.com.cn/problem/P1514",
                tags: ["最短路"]
            },
            {
                title: "P1594 护卫队",
                difficulty: "easy",
                desc: "计算护卫队从起点到终点的最短时间。",
                link: "https://www.luogu.com.cn/problem/P1594",
                tags: ["最短路"]
            },
            {
                title: "P1608 路径统计",
                difficulty: "easy",
                desc: "统计从起点到终点的最短路径条数。",
                link: "https://www.luogu.com.cn/problem/P1608",
                tags: ["最短路"]
            },
            {
                title: "P1829 [国家集训队]Crash的数字表格",
                difficulty: "medium",
                desc: "通过计算数字表格中的最短路径解决问题。",
                link: "https://www.luogu.com.cn/problem/P1829",
                tags: ["最短路"]
            },
            {
                title: "P1941 飞扬的小鸟",
                difficulty: "medium",
                desc: "计算小鸟从起点到终点的最短路径。",
                link: "https://www.luogu.com.cn/problem/P1941",
                tags: ["最短路"]
            },
            {
                title: "P2048 超级玛丽",
                difficulty: "medium",
                desc: "计算玛丽从起点到终点的最短路径。",
                link: "https://www.luogu.com.cn/problem/P2048",
                tags: ["最短路"]
            },
            {
                title: "P2132 圈地计划",
                difficulty: "medium",
                desc: "通过最短路径算法解决圈地计划问题。",
                link: "https://www.luogu.com.cn/problem/P2132",
                tags: ["最短路"]
            },
            {
                title: "P2243 考勤记录",
                difficulty: "medium",
                desc: "通过最短路径算法分析考勤记录。",
                link: "https://www.luogu.com.cn/problem/P2243",
                tags: ["最短路"]
            },
            {
                title: "P2486 [SDOI2011]染色",
                difficulty: "medium",
                desc: "通过最短路径算法解决染色问题。",
                link: "https://www.luogu.com.cn/problem/P2486",
                tags: ["最短路"]
            },
            {
                title: "P2613 【模板】有理数取余",
                difficulty: "medium",
                desc: "通过最短路径算法计算有理数取余。",
                link: "https://www.luogu.com.cn/problem/P2613",
                tags: ["最短路"]
            },
            {
                title: "P2661 信息传递",
                difficulty: "medium",
                desc: "通过最短路径算法分析信息传递路径。",
                link: "https://www.luogu.com.cn/problem/P2661",
                tags: ["最短路"]
            },
            {
                title: "P2746 [USACO5.3]校园网Network of Schools",
                difficulty: "medium",
                desc: "通过最短路径算法解决校园网连接问题。",
                link: "https://www.luogu.com.cn/problem/P2746"
            },
            {
                title: "P2865 [USACO06FEB]奶牛零食Treats for the Cows",
                difficulty: "medium",
                desc: "通过最短路径算法分配奶牛零食。",
                link: "https://www.luogu.com.cn/problem/P2865",
                tags: ["最短路"]
            },
            {
                title: "P3195 [HNOI2008]玩具装箱TOY",
                difficulty: "hard",
                desc: "通过最短路径算法解决玩具装箱问题。",
                link: "https://www.luogu.com.cn/problem/P3195",
                tags: ["最短路"]
            },
            {
                title: "P3201 [HNOI2009]梦幻布丁",
                difficulty: "hard",
                desc: "通过最短路径算法解决梦幻布丁问题。",
                link: "https://www.luogu.com.cn/problem/P3201",
                tags: ["最短路"]
            },
            {
                title: "P3245 [HNOI2016]大数",
                difficulty: "hard",
                desc: "通过最短路径算法处理大数问题。",
                link: "https://www.luogu.com.cn/problem/P3245",
                tags: ["最短路"]
            },
            {
                title: "P3376 【模板】网络最大流",
                difficulty: "hard",
                desc: "通过最短路径算法求解网络最大流问题。",
                link: "https://www.luogu.com.cn/problem/P3376",
                tags: ["最短路"]
            },
            {
                title: "P3385 【模板】负权最短路（Bellman-Ford）",
                difficulty: "hard",
                desc: "使用Bellman-Ford算法解决负权最短路问题。",
                link: "https://www.luogu.com.cn/problem/P3385",
                tags: ["最短路"]
            },
            {
                title: "P3469 [POI2008]BLO-Blockade",
                difficulty: "hard",
                desc: "通过最短路径算法解决封锁问题。",
                link: "https://www.luogu.com.cn/problem/P3469",
                tags: ["最短路"]
            },
            {
                title: "P3613 睡觉困难综合征",
                difficulty: "hard",
                desc: "通过最短路径算法解决睡觉困难问题。",
                link: "https://www.luogu.com.cn/problem/P3613",
                tags: ["最短路"]
            },
            {
                title: "P3664 [USACO17FEB]Why Did the Cow Cross the Road II S",
                difficulty: "hard",
                desc: "通过最短路径算法分析奶牛过马路问题。",
                link: "https://www.luogu.com.cn/problem/P3664",
                tags: ["最短路"]
            },
            {
                title: "P3690 【模板】差分约束算法",
                difficulty: "hard",
                desc: "通过最短路径算法实现差分约束。",
                link: "https://www.luogu.com.cn/problem/P3690",
                tags: ["最短路"]
            },
            {
                title: "P3730 [HAOI2017]旅游",
                difficulty: "hard",
                desc: "通过最短路径算法规划旅游路线。",
                link: "https://www.luogu.com.cn/problem/P3730",
                tags: ["最短路"]
            },
            {
                title: "P3953 [NOIP2017提高组]逛公园",
                difficulty: "hard",
                desc: "通过最短路径算法解决逛公园问题。",
                link: "https://www.luogu.com.cn/problem/P3953",
                tags: ["最短路"]
            },
            {
                title: "P4011 孤岛营救问题",
                difficulty: "hard",
                desc: "通过最短路径算法解决孤岛营救问题。",
                link: "https://www.luogu.com.cn/problem/P4011",
                tags: ["最短路"]
            },
            {
                title: "P4103 [HEOI2014]大工程",
                difficulty: "hard",
                desc: "通过最短路径算法处理大工程项目。",
                link: "https://www.luogu.com.cn/problem/P4103",
                tags: ["最短路"]
            },
            {
                title: "P4147 玉蟾宫",
                difficulty: "hard",
                desc: "通过最短路径算法解决玉蟾宫问题。",
                link: "https://www.luogu.com.cn/problem/P4147",
                tags: ["最短路"]
            },
            {
                title: "P4211 [LNOI2014]LCA",
                difficulty: "hard",
                desc: "通过最短路径算法计算LCA。",
                link: "https://www.luogu.com.cn/problem/P4211",
                tags: ["最短路"]
            },
            {
                title: "P4302 [JSOI2010]连通数",
                difficulty: "hard",
                desc: "通过最短路径算法计算连通数。",
                link: "https://www.luogu.com.cn/problem/P4302",
                tags: ["最短路"]
            },
            {
                title: "P4309 [TJOI2013]最长上升子序列",
                difficulty: "hard",
                desc: "通过最短路径算法解决最长上升子序列问题。",
                link: "https://www.luogu.com.cn/problem/P4309",
                tags: ["最短路"]
            },
            {
                title: "P4322 [JSOI2016]最佳团组",
                difficulty: "hard",
                desc: "通过最短路径算法解决最佳团组问题。",
                link: "https://www.luogu.com.cn/problem/P4322",
                tags: ["最短路"]
            },
            {
                title: "P4462 [CQOI2018]异或序列",
                difficulty: "hard",
                desc: "通过最短路径算法解决异或序列问题。",
                link: "https://www.luogu.com.cn/problem/P4462",
                tags: ["最短路"]
            },
            {
                title: "P4568 [JLOI2011]飞行路线",
                difficulty: "hard",
                desc: "通过最短路径算法规划飞行路线。",
                link: "https://www.luogu.com.cn/problem/P4568",
                tags: ["最短路"]
            },
            {
                title: "P4783 【模板】最大流 Dinic",
                difficulty: "hard",
                desc: "通过最短路径算法实现最大流Dinic算法。",
                link: "https://www.luogu.com.cn/problem/P4783",
                tags: ["最短路"]
            },
            {
                title: "P4878 [USACO05DEC]Layout G",
                difficulty: "hard",
                desc: "通过最短路径算法解决布局问题。",
                link: "https://www.luogu.com.cn/problem/P4878",
                tags: ["最短路"]
            },
            {
                title: "P4926 004]生日快乐",
                difficulty: "hard",
                desc: "通过最短路径算法计算生日快乐的路径。",
                link: "https://www.luogu.com.cn/problem/P4926",
                tags: ["最短路"]
            },
            {
                title: "P5017 [NOIP2018 提高组]摆渡车",
                difficulty: "hard",
                desc: "通过最短路径算法解决摆渡车问题。",
                link: "https://www.luogu.com.cn/problem/P5017",
                tags: ["最短路"]
            },
            {
                title: "P5021 [NOIP2018 普及组]货车运输",
                difficulty: "hard",
                desc: "通过最短路径算法规划货车运输路径。",
                link: "https://www.luogu.com.cn/problem/P5021",
                tags: ["最短路"]
            },
            {
                title: "P5162 WD与积木",
                difficulty: "hard",
                desc: "通过最短路径算法解决积木问题。",
                link: "https://www.luogu.com.cn/problem/P5162",
                tags: ["最短路"]
            },
            {
                title: "P5290 [十二省联考2019]春节十二响",
                difficulty: "hard",
                desc: "通过最短路径算法解决春节十二响问题。",
                link: "https://www.luogu.com.cn/problem/P5290",
                tags: ["最短路"]
            },
            {
                title: "P5321 [BJOI2019]管线",
                difficulty: "hard",
                desc: "通过最短路径算法规划管线。",
                link: "https://www.luogu.com.cn/problem/P5321",
                tags: ["最短路"]
            },
            {
                title: "P5360 [SDOI2019]世界地图",
                difficulty: "hard",
                desc: "通过最短路径算法处理世界地图问题。",
                link: "https://www.luogu.com.cn/problem/P5360",
                tags: ["最短路"]
            },
            {
                title: "P5661 [ES6HKE]旅行计划",
                difficulty: "hard",
                desc: "通过最短路径算法规划旅行计划。",
                link: "https://www.luogu.com.cn/problem/P5661",
                tags: ["最短路"]
            },
            {
                title: "P5703 【深基7.例2】苹果采购",
                difficulty: "hard",
                desc: "通过最短路径算法解决苹果采购问题。",
                link: "https://www.luogu.com.cn/problem/P5703",
                tags: ["最短路"]
            },
            {
                title: "P5787 二分图最大权匹配",
                difficulty: "hard",
                desc: "通过最短路径算法解决二分图最大权匹配问题。",
                link: "https://www.luogu.com.cn/problem/P5787",
                tags: ["最短路"]
            },
            {
                title: "P5829 [HNOI2012]矿场搭建",
                difficulty: "hard",
                desc: "通过最短路径算法解决矿场搭建问题。",
                link: "https://www.luogu.com.cn/problem/P5829",
                tags: ["最短路"]
            },
            {
                title: "P6050 [RC-06]简单题",
                difficulty: "hard",
                desc: "通过最短路径算法解决简单题。",
                link: "https://www.luogu.com.cn/problem/P6050",
                tags: ["最短路"]
            }
        ];

        // 名人名言数据
        const inspirationalQuotes = [
            {
                text: "成功的秘诀在于始终坚持自己的目标。",
                author: "本杰明·迪斯雷利"
            },
            {
                text: "我们的最大弱点在于放弃。成功的必然之路就是不断的重来一次。",
                author: "托马斯·爱迪生"
            },
            {
                text: "不要等待，时机永远不会恰到好处。",
                author: "拿破仑·希尔"
            },
            {
                text: "成功的秘诀就是每天都比别人多努力一点。",
                author: "张瑞敏"
            },
            {
                text: "编程不是关于你知道什么，而是关于你能想出什么。",
                author: "克里斯·派恩"
            },
            {
                text: "代码写得好就像是在写诗，每个字母都很重要。",
                author: "匿名程序员"
            },
            {
                text: "学习编程的最好方法就是编写大量的代码。",
                author: "林纳斯·托瓦兹"
            },
            {
                text: "计算机科学的核心是解决问题，而不是编写代码。",
                author: "理查德·汉明"
            },
            {
                text: "大多数优秀的程序员从事编程工作，不是因为期望获得报酬或得到公众的称赞，而是因为编程是件有趣的事儿。",
                author: "林纳斯·托瓦兹"
            },
            {
                text: "一名优秀的程序员，在穿越单行道时也会确认双向的来车情况。",
                author: "道格拉斯·林德"
            },
            {
                text: "这是我能想到的，唯一可以让我既当工程师又做艺术家的工作。",
                author: "安迪·赫兹菲尔德"
            },
            {
                text: "函数应该做一件事。做好这件事。只能做这一件事。",
                author: "罗伯特·C.马丁"
            },
            {
                text: "愚者困惑，智者提问。",
                author: "本杰明·迪斯雷利"
            },
            {
                text: "理论上，理论和实践没有区别。但实践上，是有区别的。",
                author: "简·范德斯奈普特"
            },
            {
                text: "百分之八十的成功只是出席。",
                author: "伍迪·艾伦"
            },
            {
                text: "我坚信，自我教育是唯一的教育形式。",
                author: "艾萨克·阿西莫夫"
            },
            {
                text: "我所学到的一切，都是从书本上得来的。",
                author: "亚伯拉罕·林肯"
            },
            {
                text: "练习成就不了完美。多练习会产生髓磷脂，是髓磷脂让你做到完美。",
                author: "丹尼尔·科伊尔"
            },
            {
                text: "只有两种编程语言：大家抱怨的和没人用的。",
                author: "本贾尼·斯特劳斯特鲁普"
            },
            {
                text: "优良设计创造价值的速度，快于其增加成本的速度。",
                author: "托马斯·C.盖勒"
            },
            {
                text: "视代码如诗词，勿要做无所谓的堆砌。",
                author: "伊利亚·多尔曼"
            },
            {
                text: "代码跑起来我们再聊。",
                author: "沃德·坎宁安"
            },
            {
                text: "除了计算机编程外，我想不出还有其他让我感兴趣的工作。",
                author: "皮特·范德林登"
            },
            {
                text: "代码胜于雄辩。",
                author: "林纳斯·托瓦兹"
            },
            {
                text: "每名程序员都是作家。",
                author: "塞坎·雷勒克"
            },
            {
                text: "我拒绝做计算机能够胜任的事情。",
                author: "奥林·施福尔"
            },
            {
                text: "神话和传说的魔力在我们这一代成真。只要在键盘上敲下正确的咒语，显示屏就像是活了过来，里面都是以前不可能存在或发生的事情。",
                author: "费德里克·布鲁克斯"
            },
            {
                text: "我从心底认为，优秀的程序员与平庸的程序员之间的区别，是在于认为自己的代码重要还是数据结构更加重要。平庸的程序员眼里只有代码，优秀的程序员则关注数据结构及之前的关系。",
                author: "林纳斯·托瓦兹"
            },
            {
                text: "算法，就像一张菜谱。",
                author: "瓦辛·拉提夫"
            },
            {
                text: "写代码时，每次都要告诉自己：最后负责维护代码的，会是一个知道你住在哪的变态暴力狂。",
                author: "约翰·伍德"
            },
            {
                text: "请注意，在'现实世界'里，演讲者的诉求永远是听众不要挑战其默认的假设条件。",
                author: "艾兹格·W·迪科斯彻"
            },
            {
                text: "没有优秀的团队，无法打造出优秀的软件。大部分的软件团队看上去就像内部不和谐的家庭。",
                author: "吉姆·麦卡锡"
            },
            {
                text: "最优秀的程序员比一般优秀的程序员，不只是好一丁半点。不论用什么标准来衡量，他们都比后者优秀太多：认知创新能力、工作效率、设计原创性或问题解决能力都是如此。",
                author: "兰道尔·斯特若斯"
            },
            {
                text: "拙劣的程序员担心代码。好的程序员担心数据结构及它们的关系。",
                author: "林纳斯•托瓦兹"
            },
            {
                text: "计算机是没有用的，它们只能给出答案。",
                author: "巴勃罗•毕加索"
            },
            {
                text: "数据！数据！数据！没有黏土我无法造出砖来！",
                author: "夏洛克•福尔摩斯"
            },
            {
                text: "软件工程的目的是控制复杂度，而不是制造复杂度。",
                author: "帕梅拉•扎维"
            },
            {
                text: "时间是阻止所有事情同时发生的力量。",
                author: "雷•卡明斯"
            },
            {
                text: "在未掌握数据之前就做出推测，是最大的错误。",
                author: "夏洛克•福尔摩斯"
            },
            {
                text: "不要降低预期去屈就性能，而要提升性能满足预期。",
                author: "拉尔夫•马斯顿"
            },
            {
                text: "数学家是现代化世界的'主人'。",
                author: "比尔•盖茨"
            },
            {
                text: "可预测性不是事物的走向，而是它们的可能趋势。",
                author: "拉海尔•法鲁克"
            }
        ];

        // 添加新标签页按钮事件
        document.querySelectorAll('.view-newtab-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                const index = parseInt(this.getAttribute('data-index'));
                const isOfficial = this.getAttribute('data-official') === 'true';
                const articles = isOfficial ? officialArticles : JSON.parse(localStorage.getItem(ARTICLES_KEY));
                const article = articles[isOfficial ? index : index - officialArticles.length];
                openSnakeArticleModal(article.title, article.content, true);
            });
        });

        function renderLearningResources() {
            const container = document.getElementById('resources-list');
            container.innerHTML = '';

            learningResources.forEach(resource => {
                const card = document.createElement('div');
                card.className = 'resource-card';
                card.innerHTML = `
            <div class="resource-title">${resource.title}</div>
            <div class="resource-desc">${resource.desc}</div>
            <a href="${resource.link}" target="_blank" class="resource-link">访问资源</a>
        `;
                container.appendChild(card);
            });
        }

        //sections['resources-link'] = 'resources-section';

        Object.keys(sections).forEach(id => {
            document.getElementById(id).addEventListener('click', function () {
                // document.querySelectorAll('.algorithm-section, #home-section, .calendar-section, .roadmap-section, .daily-section, .game-section, .weather-section, .article-section, .resources-section').forEach(section => {
                //     section.classList.remove('active-section');
                // });

                document.querySelectorAll('.algorithm-section, #home-section, .calendar-section, .roadmap-section, .daily-section, .game-section, .weather-section, .article-section').forEach(section => {
                    section.classList.remove('active-section');
                });

                const sectionToShow = sections[id];
                document.getElementById(sectionToShow).classList.add('active-section');

                if (id === 'resources-link') {
                    renderLearningResources();
                }
            });
        });

        document.addEventListener('DOMContentLoaded', function () {
            renderLearningResources();
        });

        // 渲染算法卡片
        function renderAlgorithmCards(category) {
            const container = document.getElementById('algorithm-cards');
            container.innerHTML = '';

            algorithmTemplates[category].forEach(algorithm => {
                const card = document.createElement('div');
                card.className = 'algorithm-card';
                card.innerHTML = `
                    <div class="algorithm-title">${algorithm.title}</div>
                    <div class="algorithm-desc">${algorithm.desc}</div>
                    <pre class="algorithm-code">${algorithm.code}</pre>
                    <button class="copy-btn" data-code="${encodeURIComponent(algorithm.code)}">复制代码</button>
                `;
                container.appendChild(card);
            });

            // 添加复制功能
            document.querySelectorAll('.copy-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const code = decodeURIComponent(this.getAttribute('data-code'));
                    navigator.clipboard.writeText(code).then(() => {
                        const originalText = this.textContent;
                        this.textContent = '已复制!';
                        setTimeout(() => {
                            this.textContent = originalText;
                        }, 2000);
                    });
                });
            });
        }

        // 游戏按钮点击处理函数
        function handleGameButtonClick() {
            const game = this.getAttribute('data-game');
            const gameUrls = {
                'parkour': 'https://zhangyimin12345.github.io/snake-test-game-easyparkour',
                'tetris': 'https://zhangyimin12345.github.io/snake-test-game-tetris',
                'minesweeper': 'https://zhangyimin12345.github.io/snake-test-game-minesweeper',
                'snake': 'https://zhangyimin12345.github.io/snake-test-game-snakes'
            };
            window.open(gameUrls[game], '_blank');
        }

        // 在DOM加载完成后初始化
        document.addEventListener('DOMContentLoaded', function () {
            // 初始化游戏按钮
            document.querySelectorAll('.game-btn').forEach(btn => {
                btn.addEventListener('click', handleGameButtonClick);
            });

            // 其他初始化代码...
            updateTime();
            showRandomQuote();
            // ...其他初始化
        });

        document.addEventListener('DOMContentLoaded', function () {
            // 页面加载完成后显示模态框
            document.getElementById('welcomeModal').style.display = 'flex';

            // 设置5秒后自动关闭模态框
            setTimeout(function () {
                document.getElementById('welcomeModal').style.display = 'none';
            }, 10000); // 5000毫秒即5秒

            // 添加关闭按钮点击事件
            document.querySelector('.closewelcome-btn').addEventListener('click', function () {
                document.getElementById('welcomeModal').style.display = 'none';
            });

            // 点击模态框外部区域关闭模态框
            document.getElementById('welcomeModal').addEventListener('click', function (event) {
                if (event.target == this) {
                    this.style.display = 'none';
                }
            });

            // 阻止点击关闭按钮时事件冒泡到模态框
            document.querySelector('.closewelcome-btn').addEventListener('click', function (event) {
                event.stopPropagation();
            });

            // ... 其余初始化代码保持不变 ...
        });


        // 在页面加载完成后绑定事件
        function initGameButtons() {
            document.querySelectorAll('.game-btn').forEach(btn => {
                btn.addEventListener('click', handleGameButtonClick);
            });
        }

        // 渲染竞赛日历
        function renderCalendarEvents(platform) {
            const container = document.getElementById('calendar-events');
            container.innerHTML = '';

            programmingContests
                .filter(event => platform === 'all' || event.platform === platform)
                .forEach(event => {
                    const card = document.createElement('div');
                    card.className = 'event-card';
                    card.innerHTML = `
                        <div class="event-title">${event.title}</div>
                        <div class="event-date">${event.date}</div>
                        <span class="event-platform platform-${event.platform}">${getPlatformName(event.platform)}</span>
                        <div class="event-desc">${event.desc}</div>
                        <a href="${event.link}" target="_blank" class="view-btn">查看详情</a>
                    `;
                    container.appendChild(card);
                });
        }

        function getPlatformName(platform) {
            const names = {
                'luogu': '洛谷',
                'codeforces': 'Codeforces',
                'atcoder': 'AtCoder',
                'leetcode': 'LeetCode'
            };
            return names[platform] || platform;
        }

        // 渲染学习路线
        function renderRoadmapSteps() {
            const container = document.getElementById('roadmap-steps');
            container.innerHTML = '';

            learningRoadmap.forEach(step => {
                const card = document.createElement('div');
                card.className = 'step-card';
                card.innerHTML = `
                    <div class="step-title">${step.title}</div>
                    <div class="step-level step-${step.level}">${getLevelName(step.level)}</div>
                    <div class="step-desc">${step.desc}</div>
                    <div class="step-resources">${step.resources}</div>
                `;
                container.appendChild(card);
            });
        }

        function getLevelName(level) {
            const names = {
                'beginner': '初级',
                'intermediate': '中级',
                'advanced': '高级'
            };
            return names[level] || level;
        }

        // 渲染每日一题
        function renderDailyProblems() {
            const container = document.getElementById('daily-problems');
            container.innerHTML = '';

            // 随机选择3道不同难度的题目
            const easyProblems = dailyProblems.filter(p => p.difficulty === 'easy');
            const mediumProblems = dailyProblems.filter(p => p.difficulty === 'medium');
            const hardProblems = dailyProblems.filter(p => p.difficulty === 'hard');

            const selectedProblems = [
                easyProblems[Math.floor(Math.random() * easyProblems.length)],
                mediumProblems[Math.floor(Math.random() * mediumProblems.length)],
                hardProblems[Math.floor(Math.random() * hardProblems.length)]
            ];

            selectedProblems.forEach(problem => {
                const card = document.createElement('div');
                card.className = 'problem-card';
                card.innerHTML = `
                    <div class="problem-title">${problem.title}</div>
                    <span class="problem-difficulty difficulty-${problem.difficulty}">${getDifficultyName(problem.difficulty)}</span>
                    ${problem.tags.map(tag => `<span class="event-platform">${tag}</span>`).join('')}
                    <div class="problem-desc">${problem.desc}</div>
                    <a href="${problem.link}" target="_blank" class="view-btn">查看题目</a>
                `;
                container.appendChild(card);
            });
        }

        function getDifficultyName(difficulty) {
            const names = {
                'easy': '简单',
                'medium': '中等',
                'hard': '困难'
            };
            return names[difficulty] || difficulty;
        }

        // 更新时间显示
        function updateTime() {
            const now = new Date();
            const timeStr = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            document.getElementById('time-display').textContent = timeStr;
        }

        // 显示随机名言
        function showRandomQuote() {
            const quote = inspirationalQuotes[Math.floor(Math.random() * inspirationalQuotes.length)];
            document.getElementById('quote-text').textContent = quote.text;
            document.getElementById('quote-author').textContent = `—— ${quote.author}`;
        }

        // 用户系统
        document.addEventListener('DOMContentLoaded', function () {
            // 用户数据存储在localStorage
            const USER_KEY = 'snake_test_users';
            const CURRENT_USER_KEY = 'snake_test_current_user';

            // 初始化用户数据
            if (!localStorage.getItem(USER_KEY)) {
                localStorage.setItem(USER_KEY, JSON.stringify({}));
            }

            // DOM元素
            const loginModal = document.getElementById('loginModal');
            const registerModal = document.getElementById('registerModal');
            const loginBtn = document.getElementById('loginBtn');
            const logoutBtn = document.getElementById('logoutBtn');
            const userGreeting = document.getElementById('userGreeting');

            // 显示当前用户状态
            function updateUserStatus() {
                const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
                if (currentUser) {
                    userGreeting.textContent = `欢迎你, ${currentUser.username}`;
                    userGreeting.style.display = 'inline';
                    logoutBtn.style.display = 'inline';
                    loginBtn.style.display = 'none';
                } else {
                    userGreeting.style.display = 'none';
                    logoutBtn.style.display = 'none';
                    loginBtn.style.display = 'inline';
                }
            }

            // 登录功能
            document.getElementById('loginForm').addEventListener('submit', function (e) {
                e.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;

                const users = JSON.parse(localStorage.getItem(USER_KEY));
                if (users[username] && users[username] === password) {
                    localStorage.setItem(CURRENT_USER_KEY, JSON.stringify({ username }));
                    updateUserStatus();
                    loginModal.style.display = 'none';
                    alert('登录成功!');
                } else {
                    alert('用户名或密码错误!');
                }
            });

            // 注册功能
            document.getElementById('registerForm').addEventListener('submit', function (e) {
                e.preventDefault();
                const username = document.getElementById('newUsername').value;
                const password = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;

                if (password !== confirmPassword) {
                    alert('两次输入的密码不一致!');
                    return;
                }

                const users = JSON.parse(localStorage.getItem(USER_KEY));
                if (users[username]) {
                    alert('用户名已存在!');
                } else {
                    users[username] = password;
                    localStorage.setItem(USER_KEY, JSON.stringify(users));
                    localStorage.setItem(CURRENT_USER_KEY, JSON.stringify({ username }));
                    updateUserStatus();
                    registerModal.style.display = 'none';
                    alert('注册成功!');
                }
            });

            // 退出功能
            logoutBtn.addEventListener('click', function () {
                localStorage.removeItem(CURRENT_USER_KEY);
                updateUserStatus();
                alert('您已退出登录');
            });

            // 打开登录/注册模态框
            loginBtn.addEventListener('click', function () {
                loginModal.style.display = 'flex';
            });

            // 切换登录/注册表单
            document.getElementById('showRegister').addEventListener('click', function (e) {
                e.preventDefault();
                loginModal.style.display = 'none';
                registerModal.style.display = 'flex';
            });

            document.getElementById('showLogin').addEventListener('click', function (e) {
                e.preventDefault();
                registerModal.style.display = 'none';
                loginModal.style.display = 'flex';
            });

            // 关闭模态框
            document.querySelectorAll('.close-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    loginModal.style.display = 'none';
                    registerModal.style.display = 'none';
                });
            });

            // 点击模态框外部关闭
            window.addEventListener('click', function (e) {
                if (e.target === loginModal) {
                    loginModal.style.display = 'none';
                }
                if (e.target === registerModal) {
                    registerModal.style.display = 'none';
                }
            });

            // 初始化用户状态
            updateUserStatus();
        });

        // 分类按钮点击事件
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                const category = this.getAttribute('data-category');
                renderAlgorithmCards(category);
            });
        });

        // 平台筛选按钮点击事件
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                const platform = this.getAttribute('data-platform');
                renderCalendarEvents(platform);
            });
        });

        // 其他按钮功能

        document.getElementById('luogu-team-btn').addEventListener('click', function () {
            window.open('https://www.luogu.com.cn/team/98666', '_blank');
        });

        document.getElementById('notes-link').addEventListener('click', function () {
            window.open('https://zhangyimin12345.github.io/snake-test-2-markdown/', '_blank');
        });

        document.getElementById('editor-link').addEventListener('click', function () {
            window.open('https://wbwdxh.github.io/code.html', '_blank');
        });

        // 初始化
        updateTime();
        setInterval(updateTime, 1000);
        showRandomQuote();
        setInterval(showRandomQuote, 12000); // 更换名言

        // 设置功能
        document.addEventListener('DOMContentLoaded', function () {
            // 从本地存储加载设置
            const settings = {
                waveEffect: localStorage.getItem('waveEffect') !== 'false',
                snowEffect: localStorage.getItem('snowEffect') !== 'false',
                showQuotes: localStorage.getItem('showQuotes') !== 'false'
            };

            // 初始化开关状态
            document.getElementById('wave-effect-toggle').checked = settings.waveEffect;
            document.getElementById('snow-effect-toggle').checked = settings.snowEffect;
            document.getElementById('quote-toggle').checked = settings.showQuotes;

            // 根据设置加载效果
            if (settings.waveEffect) {
                loadScript('https://api.vvhan.com/api/script/bolang');
            }

            if (settings.snowEffect) {
                loadScript('https://api.vvhan.com/api/script/snow');
            }

            if (!settings.showQuotes) {
                document.getElementById('quote-container').style.display = 'none';
            }

            // 监听开关变化
            document.getElementById('wave-effect-toggle').addEventListener('change', function () {
                const enabled = this.checked;
                localStorage.setItem('waveEffect', enabled);
                if (enabled) {
                    loadScript('https://api.vvhan.com/api/script/bolang');
                } else {
                    // 无法直接移除波浪效果，可以刷新页面
                    alert('波浪效果设置将在刷新页面后生效');
                }
            });

            document.getElementById('snow-effect-toggle').addEventListener('change', function () {
                const enabled = this.checked;
                localStorage.setItem('snowEffect', enabled);
                if (enabled) {
                    loadScript('https://api.vvhan.com/api/script/snow');
                } else {
                    // 无法直接移除雪花效果，可以刷新页面
                    alert('雪花效果设置将在刷新页面后生效');
                }
            });

            document.getElementById('quote-toggle').addEventListener('change', function () {
                const enabled = this.checked;
                localStorage.setItem('showQuotes', enabled);
                document.getElementById('quote-container').style.display = enabled ? 'block' : 'none';
            });
        });
        // 加载动画控制
        function showLoader() {
            const loader = document.getElementById('loader');
            loader.style.display = 'flex';
            loader.style.opacity = '1';
        }

        function fadeOutLoader() {
            const loader = document.getElementById('loader');
            loader.style.opacity = '0';
            setTimeout(() => {
                loader.style.display = 'none';
            }, 100);
        }

        // 页面加载完成后隐藏加载动画
        window.addEventListener('load', function () {
            setTimeout(fadeOutLoader, 100); // 延迟500毫秒隐藏以确保所有内容加载完成
        });

        window.myloader = { show: showLoader, hide: fadeOutLoader };
    </script>
</body>

</html>
